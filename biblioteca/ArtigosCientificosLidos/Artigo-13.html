<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="../format.css">
</head>
<body>
    
    <div class="header_article">
        <h1>APREÇAMENTO DE OPÇÕES DE DÓLAR NO BRASIL: UMA AVALIAÇÃO DOS MODELOS DE REDES NEURAIS.</h1>
        <h3>Leandro Maciel</h3>
        <h3>Rodrigo Lanna Franco da Silveira</h3>
        <h3>Rosangela Ballini</h3>
        <p>Research Paper</p>
        <h3>Desembro, 2009</h3>
    </div>
    
    <h2>Resumo</h2>
    <p>Neste artigo, foi aplicado um modelo de rede neural multicamadas para o apreçamento das opções de taxa de câmbio R1/US1, negociadas na Bolsa de Valores, Mercadorias & Futuros, BM&FBOVESPA, no período de janeiro de 2004 a dezembro de 2007. O desempenho do modelo foi comparado com os resultados obtidos pela fórmula analítica de Black (1976), instrumento mais utilizado pelos agentes de mercado na avaliação de opções sobre moeda estrangeira. A volatilidade foi estimada por um processo GARCH (1,1) e a curva de juros foi construída por meio da metodologia de interpolação por splines cúbicos. Os preços teóricos obtidos foram comparados com os preços reais observados no mercado. Os resultados revelaram a superioridade do modelo de inteligência artificial, em comparação ao modelo de Black, nos diferentes graus de moneyness.</p>

    <h2>1. Introdução</h2>
    <p>O desenvolvimento do modelo de Black-Scholes – B&S (Black e Scholes, 1973), na década de 1970, representou um grande avanço na teoria de finanças. A partir de um conjunto de hipóteses, Fischer Black e Myron Scholes obtiveram um método de apreçar opções européias sobre ações que não pagam dividendos, sendo o prêmio de uma call ou uma put uma função do preço do ativo objeto, preço de exercício, tempo de maturidade, taxa de juro livre de risco e volatilidade do preço do ativo-objeto. Tais hipóteses são baseadas nos seguintes pontos: i) o preço da ação segue um movimento geométrico Browniano, em que a distribuição de probabilidade dos preços é lognormal, com média e variância constantes; ii) a taxa de juro livre de risco de curto prazo é conhecida e constante para qualquer vencimento; iii) a volatilidade é constante até o vencimento; iv) há possibilidade de emprestar e tomar emprestado à mesma taxa de juro livre de risco; v) inexiste o pagamento de dividendos durante a vida da opção; vi) o ativo-objeto do contrato é perfeitamente divisível, sendo que sua negociação é contínua e não possui custos de transação ou impostos; vii) não se verificam oportunidades de arbitragem sem risco (Hull, 2006).</p>
    <p>Um entrave ao modelo se encontra no fato de que os dados reais com freqüência violam suas hipóteses subjacentes. Essas violações podem ser observadas nas seguintes situações: (1) ao invés da descrição de um caminho aleatório, a teoria dos fractais pode ser uma melhor hipótese para o movimento do mercado (Peters, 1994) - ademais, Akgiray (1989) ainda rejeita a hipótese de variância constante para o preço das ações; (2) opções americanas ou bermudas são as mais comercializadas nos mercados - os agentes optam por maiores chances de exercício quando os mercados estão voláteis, assim como quando estão próximos ao pagamento de dividendos; (3) o pagamento de dividendos é uma prática comum, especialmente no mercado de ações.</p>
    <p>Na tentativa de superar as violações citadas acima e se adequar aos diversos tipos de opções que surgiram, vários trabalhos foram e vêm sendo desenvolvidos. Neste processo de evolução, modelos baseados em Redes Neurais Artificiais (RNAs) vêm ganhando espaço na literatura de finanças. Trata-se de uma técnica computacional inspirada no funcionamento do sistema nervoso biológico, motivada para a compreensão de relações e padrões de diferentes naturezas, em que permite a modelagem de relações do tipo entrada-saída (input-output). Muitos estudos com avaliações de redes neurais aplicadas à modelagem financeira podem ser encontrados na literatura.</p>
    <p>Hutchinson et al (1994), por exemplo, avaliaram uma abordagem de redes neurais para o apreçamento e aplicação da operação delta-hedge nas opções sobre futuros do índice S&P 500, no período de 1987 a 1991. Seus resultados mostraram que as redes neurais foram capazes de aprender o funcionamento da fórmula de Black-Scholes, com uma amostra para ajuste dos parâmetros composta por preços diários das opções no período de dois anos. Sobretudo, foi possível apreçar e formar operações delta-hedge com sucesso para opções não utilizadas na amostra apresentada à rede. Os autores sugeriram que o apreçamento por tal método pode ser mais eficiente quando a dinâmica do ativo objeto da opção é desconhecida.</p>
    <p>O estudo de Qi e Maddala (1996), por sua vez, aplicou um modelo de rede neural multicamadas recorrente para o apreçamento de calls sobre o índice S&P 500 no período que compreende dezembro de 1994 a janeiro de 1995. Os resultados apresentaram a superioridade do método de inteligência artificial em comparação à fórmula de Black-Scholes. Com base na análise dos pesos da rede neural, confirmaram que quanto menor o preço de exercício ou maior o preço do ativo objeto ou, ainda, quanto mais distante o prazo para o vencimento, maior será o preço da call.</p>
    <p>Outra pesquisa que se observa o uso de redes neurais para opções é o de Lajbcygier et al (1996). Os autores utilizaram dois modelos para apreçar opções sobre o futuro do índice representativo das ações ordinárias comercializadas no mercado de ações australiano. O primeiro deles teve duas variáveis de entrada (quociente do preço spot e o preço de exercício, e o prazo de vencimento do papel). Já o segundo utilizou as mesmas variáveis, adicionando a taxa de juros e a volatilidade (estimada por meio da volatilidade histórica com uma janela de 60 dias), na tentativa de comparar com o modelo utilizado por Hutchinson et al (1994). Os resultados mostraram que o modelo com quatro variáveis de entrada superou o modelo de duas variáveis, assim como a metodologia de Black-Scholes.</p>
    <p>Para o mercado brasileiro, Freitas e Souza (2002) avaliaram o modelo de redes neurais para precificar opções de compra européias sobre a ação da Telebrás PN, no período de janeiro de 1995 a dezembro de 1999. A rede neural aplicada pelos autores apresentou resultados superiores em comparação ao modelo de Black-Scholes, especialmente quando as calls estavam in-the-money.</p>
    <p>Outras pesquisas podem ainda ser citadas, como a de Geigle e Aronson (1999) e Malliaris e Salchenberger (1996). Estes primeiros examinaram o desempenho das redes neurais para a avaliação de opções americanas sobre futuro do índice S&P 500 e confirmaram a superioridade do modelo se comparado ao de Black-Scholes. Já Malliaris e Salchenberger (1996) desenvolveram um modelo de rede neural para a previsão da volatilidade futura das opções sobre futuro do índice S&P 100, com base na volatilidade passada e outros fatores que afetavam os preços das opções comercializadas neste mercado. A rede foi estruturada com mais 13 fatores de entrada e a estimativa da volatilidade permitiria aos agentes estabelecer posições estratégicas na antecipação de mudanças nos movimentos do mercado. Os resultados da rede neural foram comparados com a volatilidade implícita das opções, obtidas pelo modelo de Black-Scholes. De acordo com os seus resultados, a estimação da volatilidade pelo modelo de redes neurais foi superior às modelagens de volatilidade histórica e implícita.</p>
    <p>Embora a superioridade dos modelos de redes neurais, em comparação aos métodos usuais de apreçamento de opções, seja quase um consenso entre os pesquisadores, Callen et al (1996) afirmam que estas técnicas não apresentam, necessariamente, os melhores resultados aos modelos lineares de séries temporais, mesmo quando aplicados a séries financeiras, sazonais ou não-lineares. Com isso, é necessária a condução de estudos para diferentes mercados e com a utilização de diferentes modelos de redes neurais na tentativa de inferir sua superioridade ao modelo de BlackScholes. Diante deste contexto, este artigo teve o objetivo de aplicar um modelo de rede neural recorrente multicamadas, baseado no algoritmo backpropagation, para valoração das opções de compra de taxa de câmbio R1/US1, negociadas na Bolsa de Valores, Mercadorias & Futuros – BM&FBOVESPA, no período de 2004 a 2007. A fim de avaliar tal modelo, as opções também foram apreçadas pelo modelo de Black, metodologia utilizada pelos agentes no mercado brasileiro para opções sobre moeda estrangeira, e, em seguida, os resultados foram comparados com os prêmios observados no mercado.</p>

    <h2>3. Análise e Discussão dos Resultados</h2>
    <p>Para confrontar o desempenho do modelo baseado em redes neurais com a fórmula analítica de Black, foram comparados os preços teóricos das opções obtidos por meio de cada modelo com os preços observados no mercado. Nessa comparação, os dados utilizados pertencem ao grupo de teste da estruturação da rede neural, uma vez que o conjunto treinamento e validação foram utilizados para que a rede pudesse determinar seus parâmetros e aprender o processo gerador dos preços de compra das opções de dólar. Dessa forma, o conjunto teste permite avaliar a capacidade de aprendizado e generalização da rede para precificar as opções com dados de entrada nunca antes apresentados à rede. O conjunto teste é composto por negociações que se iniciam em 04/10/2007 e vão até 31/12/2007, compondo uma amostra de 466 observações. A Tabela 1 apresenta os resultados dos valores das métricas de erro utilizadas neste trabalho para os modelos teóricos avaliados, assim como o coeficiente de determinação da regressão dos preços do mercado sobre os preços teóricos.</p>
    <p>Por meio da avaliação dos erros obtidos, ao se observar os resultados da Tabela 1, pode-se verificar que o modelo de redes neurais apresentou preços teóricos mais próximos aos preços de mercado, explicando o baixo EPM, MEP e EQRM, em comparação ao modelo de Black. Além disso, o baixo desempenho do modelo de Black foi observado em toda a amostra dos dados. A Tabela 2 apresenta os valores das métricas de erro para toda a amostra, totalizando 4.642 observações, divididas nos conjuntos de treinamento, validação e teste.</p>
    <p>Nota-se, pela Tabela 2, que o modelo de Black apresentou erros relativamente iguais nas amostras, uma vez que não faz diferença a distinção entre elas para a aplicação da fórmula analítica. Entretanto, como era de se esperar, nos conjuntos treinamento e validação, para a rede neural, os erros foram muito baixos, se comparados aos próprios resultados do conjunto teste da rede neural e aos resultados do modelo de Black, visto que foram os dados apresentados à rede e que a estruturaram de forma a convergir para o nível de erro estipulado de acordo com o processo de aprendizagem supervisionado.</p>
    <p>Os resultados, portanto, foram favoráveis à metodologia das redes neurais. Esse fato se confirma ao se observar o 2 R da regressão dos preços de mercado sobre os preços teóricos (Tabela 1). Entretanto, deve-se notar que, mesmo assim, os preços do mercado não são explicados fundamentalmente pelos preços teóricos, ou seja, outros fatores podem ajudar a determinar os preços dessas opções. Porém, em geral, os valores dos erros para o modelo proposto foram muito pequenos em comparação ao modelo de Black, evidenciando que a rede foi capaz de se aproximar melhor ao processo gerador do preço das opções de compra de dólar no mercado brasileiro.</p>
    <p>As médias dos erros para os dois modelos foram elevadas e são significativamente diferentes de zero. Além disso, algumas observações apresentaram erros relativos superiores a 50%, indicando uma inadequação dos modelos para o apreçamento, como também o possível caso de erros grosseiros de informação. Esses dados podem ser vistos como outliers, mas, mesmo assim, continuaram na amostra, uma vez que se intencionou uma modelagem de caráter geral. Também, no período avaliado, a dinâmica de comportamento do ativo objeto, preço do dólar, não apresentou um movimento adverso capaz de explicar tais resultados, como uma reversão nas expectativas dos agentes, por exemplo, ou até mesmo a verificação de um fator exógeno que se reverteu numa inflexão da tendência do movimento da taxa cambial entre o dólar e o real.</p>
    <p>Foram avaliados, ainda, os resultados dos modelos de acordo com o grau de moneyness (M) das opções. Verificou-se que 43% das opções da amostra teste estão dentro do preço, enquanto 31% e 26% estão no dinheiro e fora do dinheiro, respectivamente. A Tabela 3 apresenta os resultados das métricas de erro para o conjunto da amostra teste de acordo com o grau de moneyness das opções. Observa-se que tanto o modelo de Black quanto o de rede neural foram mais acurados no apreçamento das opções in-the-money. Os maiores níveis de erro foram verificados nas opções outof-the-money, principalmente para o modelo de Black. Na amostra que compõe as opções at-the-money, os resultados dos modelos foram mais semelhantes, como se pode notar pelas métricas do EPM e do MEP. Entretanto, nos diferentes graus de moneyness, os resultados do modelo de RNA foram superiores em comparação ao modelo de Black.</p>
    <p>O Gráfico 1 ilustra o resultado obtido para as opções in-the-money. Selecionou-se a call mais líquida, que esteve dentro do dinheiro no período de análise – strike R11.850/US11.000 e vencimento janeiro de 2008, observando-se a evolução dos prêmios de mercado e dos resultados dos modelos. Verifica-se que ambos os modelos utilizados apresentaram preços teóricos muito próximos aos preços observados no mercado. Entretanto, o modelo de Black apresentou erros mais significativos de acordo com o aumento do prazo entre a negociação e o vencimento do contrato.</p>
    <p>Para as opções out-of-the-money, os resultados do modelo de rede neural se destacam pela sua superioridade em relação ao modelo de Black. No Gráfico 2, como forma de ilustrar o fato acima citado, foi analisada a evolução dos prêmios de mercado e dos prêmios teóricos de uma série fora do dinheiro com alta liquidez – strike de R1 2.000 e vencimento em janeiro de 2008. É possível observar o bom desempenho obtido pelo modelo de redes neurais para a avaliação das opções estudadas. Constata-se que, para as opções com vencimentos mais curtos, os modelos teóricos apresentaram resultados similares, porém, o modelo de Black resultou em erros de apreçamento maiores de acordo com a elevação da maturidade da opção.</p>
    <p>Os resultados apresentados evidenciam que o modelo de rede neural proposto melhor se adéqua ao mercado de opções de compra de dólar no Brasil, em comparação ao método de Black, modelo bastante utilizado pelos agentes de mercado. O modelo de Black apresentou piores resultados nas opções com baixo grau de moneyness, sendo que o modelo de rede neural resultou em preços teóricos muito próximos aos preços reais para os mesmos papéis, evidenciando sua superioridade.Vale ressaltar, ainda, que uma grande vantagem da aplicação de redes neurais para a valoração de opções se encontra no fato do modelo não requerer nenhuma hipótese restritiva com relação às variáveis de entrada e demais pressuposições, uma vez que se trata de um modelo para compreender padrões lineares de alta complexidade.</p>

    <h2>4. Conclusões</h2>
    <p>O apreçamento de ativos financeiros apresenta inúmeras dificuldades para os agentes econômicos em geral, uma vez que tais preços são influenciados por choques econômicos, políticos e internacionais, que fazem com que os modelos tradicionais não sejam suficientes para explicar os valores desses ativos transacionados nos mercados, como também os próprios modelos são baseados em hipóteses que não se verificam na realidade. Dessa forma, a chamada engenharia financeira vem apresentando diversas alternativas para avaliação desses instrumentos, como por exemplo, o método de redes neurais. As redes neurais artificiais possuem a habilidade de modelar padrões não lineares e aprender com base em dados históricos. Sua aplicação para apreçamento de opções tem sido apresentada recentemente pela literatura e os resultados encorajam a utilização deste modelo, em comparação aos utilizados pelas instituições financeiras.</p>
    <p>Este trabalho avaliou o poder de generalização das redes neurais para a valoração de opções de compra de dólar comercializadas no mercado brasileiro, BM&FBOVESPA. Foram avaliadas as opções para o período de 2004 a 2007, num total de 4.642 observações. Estruturou-se um modelo de rede neural recorrente multicamadas baseado no algoritmo backpropagation, método de aprendizagem supervisionado mais utilizado na literatura sobre redes neurais. As mesmas opções foram precificadas pelo modelo de Black, metodologia utilizada pelos agentes no mercado brasileiro para opções sobre moeda estrangeira. Ambos os modelos se basearam nas variáveis fundamentais que afetam o preço de uma opção: preço do ativo objeto, preço de exercício, taxa de juro livre de risco, prazo de vencimento da opção e volatilidade. A taxa de juro livre de risco foiobtida pelo método de interpolação de splines cúbicos e a volatilidade estimada por um processo GARCH (1,1). Os resultados dos modelos, i.e. preços teóricos, foram comparados com os preços reais observados no mercado por meio do Erro Percentual Médio, Máximo Erro Percentual e Erro Quadrático Relativo Médio.</p>
    <p>Os resultados mostraram que os preços das opções de compra de dólar comercializadas no mercado brasileiro são obtidos mais acuradamente por meio do modelo proposto de rede neural. Os valores relativamente baixos das métricas de erro permitiram inferir a superioridade do modelo em comparação aos resultados da fórmula analítica de Black. Entretanto a regressão dos preços de mercado sobre os preços teóricos mostrou que os preços de mercado não são fundamentalmente explicados pelos preços teóricos, o que implica erros de avaliação do mercado ou do próprio modelo e, dessa forma, pode permitir arbitragem pelos agentes.</p>
    <p>Trabalhos futuros compreendem estudos para a estimação da volatilidade desses contratos, por meio do método de redes neurais. Pode-se estruturar um modelo de rede, baseado na volatilidade implícita dessas opções, para então aprender o processo gerador da volatilidade desses ativos e, então, pela estimação da volatilidade obtida pelo modelo de rede neural, inserir como dado de entrada em uma nova rede essa volatilidade, na tentativa de se aproximar dos preços observados nos mercados. Além disso, novos algoritmos de treinamento podem ser comparados ao backpropagation, assim como se testar novas estruturas na intenção de se obter melhores resultados.</p>

</body>
</html>