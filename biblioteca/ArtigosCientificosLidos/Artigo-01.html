
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="../format.css">
    </head>
<body>
    <h1 class="title">REDES NEURAIS CONVOLUCIONAIS APLICADAS À NEGOCIAÇÃO DE ATIVOS NO MERCADO FINANCEIRO</h1>
    <h3 class="author">DAVI GUARACHO NASCIMENTO</h3>
    <p  class="desc">Dissertação de mestrado apresentada ao Centro Universitário da FEI para obtenção do título de Mestre em Engenharia Elétrica, orientada pelo Prof. Dr. Reinaldo Augusto da Costa Bianchi.</p>
    <p  class="data">São Bernardo do Campo, 2021</p>
    <h2>RESUMO</h2>
        <p>Previsão do mercado financeiro tem sido um desafio bastante popular nas pesquisas de Aprendizado de Máquina (AM).</p>
        <p>O desejo da maioria dos investidores é tomar decisões com base em critérios objetivos que venham a proporcionar maior retorno nas operações.</p>
        <p>Recentemente, estudos têm usado técnicas de Aprendizado Profundo (AP), como Redes Neurais Convolucionais (Convolutional Neural Networks - CNN), para realizar regressão nos preços ou classificação de sinal de negociação em ativos do mercado financeiro.</p>
        <p>Neste trabalho, é proposta uma arquitetura de sistema que utilizada uma CNN a fim de realizar a indicação da melhor operação para cada momento no mercado de ações, este sistema foi chamado CNN Trading Classifier (CNN-TC).</p>
        <p>Este sistema é composto por pré-processamento dos dados, classificação pelo modelo CNN e tomada de decisão no mercado.</p>
        <p>Isso foi avaliado com base em dados das bolsas de valores brasileira e americana em três períodos diferentes, para isto foram feitas avaliação estatística, utilizando as métricas de classificação acurácia, precisão, revocação e F1, e financeira com base nas classificações realizadas pelo modelo.</p>
        <p>Além disso foi realizado um teste em ambiente simulado utilizando o software MetaTrader a fim de atestar a eficácia desta abordagem.</p>
        <p>Os resultados mostram que o sistema teve resultados estatísticos e financeiros melhores na maioria das avaliações em comparação com o uso de outros modelos de AP e superou a estratégia Buy and Hold (BH) e retornos da renda fixa.</p>
    <h2>INTRODUÇÃO</h2>
        <p>O desejo da maioria dos investidores e pessoas que operam no mercado financeiro é basear suas decisões em critérios objetivos que venham a proporcionar maior retorno nas operações. Nos últimos anos, previsão do mercado financeiro tem sido um tema muito explorado na comunidade de Aprendizado de Máquina por pesquisadores na área de finanças. Na literatura, diversas técnicas de Aprendizado Profundo, alinhadas com a Análise Técnica, têm sido aplicadas buscando encontrar soluções para este desafio de forma que seja possível obter um retorno financeiro expressivo nas negociações de ativos financeiros.</p>
        <p>O número de pessoas realizando operações no mercado financeiro, assim como o volume financeiro negociado, tem crescido nos últimos anos e como resultado, a busca pelo desenvolvimento de sistemas de decisão inteligentes está recebendo cada vez mais atenção nos mercados financeiros globalmente. No Brasil, o mercado de ações cresceu de forma significativa nos últimos anos. Dados fornecidos pela Economatica, em 2020, evidenciam o crescimento do volume financeiro negociado em ações entre 1994 e o primeiro semestre de 2020, conforme mostrado na Figura 1.</p>
        <p>Os preços das ações são naturalmente altamente voláteis, e escolher o momento ideal para comprar ou vender pode ser uma tarefa complexa, dependendo de muitas variáveis; esta é uma razão pela qual a estratégia Buy and Hold (BH) é a escolha preferida por muitos investidores. BH consiste em uma estratégia de comprar e manter ações ao longo do tempo, considerando que está se valorizará no longo prazo. Desta forma o investidor não se preocupa com a volatilidade dos preços, poupando a si mesmo de tomar decisões baseado em suas emoções. Entretanto, esta metodologia de investimento exige acompanhamento de resultados e balanços das empresas, bem como o comportamento de seus preços, para decidir quando uma ação está barata/cara o suficiente que mereça ser comprada/vendida.</p>
        <p>Segundo a Hipótese do Mercado Eficiente, a flutuação dos preços das ações desconta todas as informações conhecidas sobre elas, bem como as preocupações e expectativas do mercado com relação ao futuro da empresa. Já a teoria do do Passeio Aleatório, afirma que o mercado financeiro funciona de forma irracional, sendo os movimentos dos preços imprevisíveis, seguindo um "passeio aleatório". Sendo assim, um investidor individual muitas vezes não dispõe de tempo ou conhecimento suficiente para avaliar empresas do ponto de vista de seus fundamentos e recorrem à chamada Análise Técnica (BULKOWSKI, 2011). Esta estratégia consiste em realizar operações de compra e venda a fim obter ganhos de capital nas flutuações dos preços.</p>
        <p>Na tentativa de auxiliar nesta tomada de decisão e prever tendências futuras no mercado de ações, os investidores aprofundaram os estudos em Análise Técnica nos últimos anos. Este tipo de análise tem por objetivo encontrar regiões de interesse no preço e momentos para compra e venda baseando-se no histórico de preços passados. Padrões de gráficos de Candlestick (EDWARDS; BASSETTI; MAGEE, 2012) e vários indicadores técnicos (COLBY; MEYERS, 1988) foram desenvolvidos usando as cotações históricas para encontrar o melhor ponto de entrada de operação. Entre os mais populares, pode-se citar os indicadores rastreadores de tendências, de volatilidade e outros baseados no volume financeiro negociado (COLBY; MEYERS, 1988).</p>
        <p>Atualmente, existem estratégias de investimento sofisticadas que fazem o uso combinado da Análise Fundamentalista com a Análise Técnica para selecionar empresas e tomar decisões de momentos de operação no mercado. Um exemplo são os fundos de investimento quantitativos, os quais utilizam algoritmos computacionais para analisar dados das empresas e do mercado de ações.</p>
        <p>Segundo Li (2019), atualmente aproximadamente 80% das negociações realizadas no mercado de ações norte americano são automatizadas, o que significa que cada vez mais o mercado tem reagido às manchetes e está mais propenso a oscilações bruscas de preços devido aos algoritmos que exercem grande influência no mercado.</p>
        <p>Na literatura, podemos encontrar algumas abordagens que utilizam diversas técnicas diferentes de AM para prever tendências ou preços futuros do mercado, tais como Máquina de Vetores de Suporte (Support Vector Machines - SVM), Rede Neural Recorrente (Recurrent Neural Network - RNN), Rede de Memória de Curto Longo Prazo (Long Short Term Memory - LSTM) e Rede Neural Convolucional (Convolutional Neural Network - CNN).</p>
        <p>Dentre estes, a CNN é conhecida como um modelo de RNA eficaz para a extração de padrões em muitas áreas e tem sido o modelo de AP mais comumente adaptado para diversos problemas, tais como classificação e reconhecimento de objetos em visão computacional e Processamento de Linguagem Natural (PLN). Na competição chamada ImageNet, focada em visão computacional, a rede AlexNet  alcançou uma taxa de sucesso de 60 a 65% e, mais recentemente, a GooLeNet , Inception  e ResNet  alcançaram aproximadamente 75-80% de taxa de sucesso .</p>
    <h2>MOTIVAÇÃO</h2>
        <p>O investimento no mercado financeiro requer gestão sobre muitas variáveis para que não se tenha prejuízo.</p>
        <p>Ainda que exista certa complexidade inerente a este tipo de investimento, devido à taxa de juros baixa no ano atual, a renda variável tem atraído muitos investidores devido à possibilidade de retornos melhores em comparação com a renda fixa.</p>
        <p>O interesse em reduzir os riscos e manter um retorno expressivo é comum na maioria dos investidores, bem como o desejo destes em aumentar os retornos nas operações.</p>
        <p>Dessa forma, a melhoria de técnicas de previsão e de gestão e controle de risco auxilia fortemente na tomada de decisão.</p>
        <p>Além disso, existem fundos de investimentos especializados em investimentos utilizando estratégias quantitativas. </p>
        <p>Esta estratégia consiste na utilização de modelos matemáticos e algoritmos computacionais a fim de avaliar oportunidades de investimento de forma a alcançar resultados consistentes.</p>
        <p>Sendo assim, o estudo de previsão com uso de RNAs aplicadas a finanças computacionais torna este trabalho relevante devido à carência de estudos nesta área no Brasil.</p>
    <h2>OBJETIVOS</h2>
        <p>O objetivo deste trabalho é propor uma nova abordagem intitulada CNN Trading Classifier (CNN-TC) para analisar e classificar séries temporais utilizando um modelo de CNN visando identificar o melhor momento de negociação de ações no mercado financeiro a fim de construir uma estratégia de operação mais rentável.</p>
        <p>A seguir são listados os objetivos específicos desta pesquisa:</p>
        <p>Desenvolver um sistema utilizando um modelo de AP dinâmico para previsão de mercados financeiros;</p>
        <p>Avaliar esta abordagem com base em métricas estatísticas;</p>
        <p>Comparar os resultados de experimentos simulados usando dados históricos passados do mercado financeiro com outros benchmarks (índices de referência comumente utilizados para avaliar o retorno de um investimento) a fim de avaliar a viabilidade deste sistema;</p>
        <p>Avaliar a aplicabilidade em cenário real simulado de operação utilizando um robô em uma plataforma de negociação simulada;</p>
    <h2>JUSTIFICATIVA</h2>
        <p>Esta pesquisa justifica-se pela sua contribuição para melhorar a relação de risco e retorno constante em aplicações no mercado de capitais e auxiliar na tomada de decisão no mercado de ações. </p>
        <p>Espera-se ainda que este trabalho auxilie no desenvolvimento de novas técnicas de previsão e predição com a utilização de outros modelos semelhantes.</p>
        <p>O uso de RNA pode reduzir a incerteza em vários aspectos das estratégias de investimento, bem como melhorar a gestão do risco delas. </p>
        <p>Neste trabalho será abordado, principalmente, a identificação da melhor oportunidade de operação com base na previsão de tendências de retornos, com avaliação financeira das operações realizados pelas estratégias automatizadas.</p>
    <h2>ORGANIZAÇÃO DO TRABALHO</h2>
        <p>Além deste capítulo introdutório, o restante deste trabalho está estruturado em 6 capítulos da seguinte forma: o capítulo 2 apresenta a revisão bibliográfica e os trabalhos relacionadosa esta proposta. </p>
        <p>O capítulo 3 discorre sobre a fundamentação teórica necessária para a compreensão e reprodução deste trabalho. </p>
        <p>Na sequência, no capítulo 4 é definido o sistema proposto. </p>
        <p>A metodologia de treinamento utilizada, bem como a descrição dos experimentos realizados são apresentadas no capítulo 5. </p>
        <p>O capítulo 6 apresenta os resultados acompanhada de uma discussão sobre os mesmos. </p>
        <p>Por fim, o capítulo 7 apresenta a conclusão deste trabalho e os trabalhos futuros.</p>
    <h2>TRABALHOS CORRELATOS</h2>
        <p>Neste capítulo serão apresentadas algumas abordagens para previsão de mercados financeiros que foram desenvolvidas utilizando modelos de AP. Algumas implementações tiveram como base a realização de regressão sobre de dados financeiros, enquanto outras foram baseadas no uso de indicadores técnicos para realizar classificação sobre séries temporais.</p>
        <p>Bao, Yue e Rao (2017) propuseram uma abordagem de AP para prever o preço de fechamento do dia seguinte usando as transformadas Wavelet e auto-codificadores combinados com uma arquitetura LSTM a fim de tomar decisões no mercado financeiro. Os resultados fornecem evidências de que o modelo é capaz de prever séries temporais com boas métricas e desta auxiliar estratégias de investimento para superar o método de investimento BH e as abordagens usando sistema de negociação que implementam apenas LSTM e RNN puras.</p>
        <p>Selvin et al. (2017) basearam sua pesquisa nas arquiteturas LSTM e CNN para prever os preços futuros das ações do mercado de ações da Índia. Os experimentos mostraram que a arquitetura CNN é capaz de identificar as mudanças nas tendências e foi o melhor modelo na comparação, o que evidencia a capacidade deste modelo de RNA em identificar padrões sobre séries temporais.</p>
        <p>Sezer, Ozbayoglu e Dogdu (2017) propuseram um sistema utilizando MLP composto por quatro camadas para classificar o sinal de negociação no mercado de ações Dow Jones para cada dia. Os dados de entrada utilizados eram um conjunto de indicadores técnicos composto por: Índice de Força Relativa (Relative Strength Index - RSI), Williams %R e Convergência e Divergência de Médias Móveis (Moving Average Convergence Divergence - MACD). Segundo os autores, o sistema desenvolvido executou a tarefa de classificação de compra, venda ou neutro na indicação diária ao longo de um período e mostrou resultados promissores. Além disso, os resultados mostram que os indicadores selecionados contribuem para a tarefa de classificação de séries temporais e apresentam boa correlação com o movimento dos preços dos ativos.</p>
        <p>Samarawickrama e Fernando (2017) fizeram uma comparação entre alguns modelos na previsão de preços futuros no mercado financeiro Colombo Stock Exchange (CSE). Os modelos escolhidos foram MLP, Unidade Recorrente Chaveada (Gated Recurrent Unit - GRU), LSTM e Rede Neural Recorrente Simples (Simple Recurrent Neural Network - SRNN). Como entrada dos modelos foram utilizados os preços de máxima, mínima e fechamento de dois dias consecutivos. Como conclusão, foi avaliado que LSTM e SRNN tiveram menos erros em geral, exceto em casos específicos, onde o MLP teve melhores resultados. O modelo GRU teve o pior resultado em acurácia quando comparado com os outros modelos. Este trabalho evidencia que os modelos de RNNs são mais aplicáveis em tarefas de regressão.</p>
        <p>Tsantekidis et al. (2017) propuseram um sistema utilizando CNN para análise do livro de ofertas dos ativos a fim de identificar a tendência do preço em instantes seguintes. O trabalho teve por objetivo propor uma abordagem capaz de realizar negociação de alta frequência, ou seja, obter lucro financeiro em pequenas variações do preço ao longo do dia. O sistema proposto foi comparado com o uso de SVM e MLP. Os resultados demonstram que a CNN apresenta resultados melhores para esta tarefa de classificação, alcançando precisão próxima de 70% frente a 60% dos demais. Este trabalho também demonstra que um modelo CNN pode ser usado para classificar tendência no mercado financeiro</p>
        <p>Nelson, Pereira e Oliveira (2017) utilizaram um modelo de LSTM na tarefa de predição de tendência futura para ações no mercado financeiro brasileiro utilizando indicadores técnicos. As variáveis de entrada somaram 180, considerando indicadores e histórico de preços (máxima, mínima, abertura e fechamento) em intervalos de 15 minutos e o modelo informava se o preço iria subir ou cair. Os resultados apresentam acurácia próxima de 55,9%. Além disso o retorno financeiro utilizando o sistema como tomada de decisão foi positivo no período de avaliação, enquanto o retorno dos ativos analisados foi negativo. Isto evidencia que o modelo LSTM pode ser utilizado para classificar tendência futuras sobre séries temporais. Fischer e Krauss (2018) utilizaram um modelo de LSTM para realizar previsão no mercado financeiro. O estudo utilizou o índice S&P 500 entre os anos 1992 e 2005 e foram feitas comparações com modelos de Random Forest (RAF) e Logistic Regression Classifier (LOG). Como conclusão os autores afirmam que o modelo LSTM é o mais adequado para previsão de valores série temporal, superando modelos mais simples de forma evidente.</p>
        <p>Jain, Gupta e Moghe (2018) desenvolveram três abordagens diferentes de regressão utilizando CNN, LSTM e CNN-LSTM para a tarefa de previsão de preços futuros. Todos os modelos foram baseados em convoluções 1D e os dados de entrada utilizados eram compostos de preços diários de abertura, máxima, mínima e fechamento dos últimos 5 dias úteis consecutivos. Os resultados mostraram que os modelos de RNA podem ser empregados na previsão de preços futuros de dados de ações e uma combinação de CNN-LSTM é capaz de fornecer resultados mais precisos quando comparados a cada arquitetura individualmente. Além disso, o trabalho reforça que um modelo CNN possibilidade a identificação de padrões, enquanto o LSTM complementa o resultado final realizando a previsão de valores de série temporal com base nos padrões destacados pela CNN.</p>
        <p>Nobre e Neves (2019) em seu artigo utilizou transformadas de Wavelets com Extreme Gradient Boosting (XGBoost) e PCA para realizar previsão de tendências no mercado de ações. Para isto foram gerados 26 indicadores técnicos junto do histórico de preços de abertura, máxima, mínima e fechamento. Foi utilizado o PCA para extrair as variáveis mais relevantes e reduzir dimensionalidade. O conjunto de dados resultante foi então alimentado para um classificador binário XGBoost. Segundo os autores, os resultados obtidos mostram que este sistema é capaz de superar a estratégia BH em três dos cinco mercados financeiros analisados, com uma média de retorno de 49,26%, enquanto o BH teve em média 32,41%. Este trabalho demonstra que o movimento dos preços e melhor escolha dos indicadores, selecionando so que possuem maior correlação com os preços, podem ser aplicáveis em algoritmos de AM para previsão.</p>
        <p>Cao e Wang (2019) desenvolveram dois sistema utilizando CNN e uma combinação CNN-SVM para realizar regressão nos valores do índice do mercado financeiro da Tailândia, Thai Stock Exchange. Os resultados mostraram grande eficiência na previsão dos valores do índice e o modelo combinado de CNN-SVM apresentou grande correlação com os preços reais e altas taxas de acurácia.</p>
        <p>Sayavong, Wu e Chalita (2019) também desenvolveram um sistema de regressão baseado em CNN para realizar regressão em três ações do índice do mercado de ações da Tailândia. O sistema utilizou como dados de entrada os valores histórico de preços de abertura, máxima, fechamento e mínima dos ativos. Segundo os autores, os resultados mostraram que o modelo pode efetivamente identificar as tendências variáveis dos preços das ações e prever preços futuros com boas taxas de acurácia, podendo fornecer uma referência importante sobre o possível futuro comportamento do mercado.</p>
        <p>Wang et al. (2018) desenvolveram uma abordagem utilizando modelo de CNN baseado em convoluções de tipos de dados separados. Os dados foram dispostos em formato de matriz 2D, cada linha representando uma série temporal de um elemento de entrada. Para as camadas convolucionais, foi utilizado um processo de escaneamento 1D; cada filtro passeia em cada tipo de dado, ao final da matriz, o filtro retorna ao início e segue para a próxima linha. A ideia era extrair padrões temporais que pudessem representar a direção do preço, sendo invariante à ordem de entrada dos elementos. A Figura 2 apresenta a CNN utilizada na proposta. Como se pode ver, o histórico de preços são dispostos nas linhas da matriz de entrada e as convoluções são realizadas em cada elemento de forma independente. As amostras são rotuladas com base no preço do dia seguinte considerando a volatilidade recente nos preços. Como saída da rede tem-se as seguintes possibilidades: subir, cair ou neutro, caso o mercado não ultrapasse os valores de algumas das outras classes. A proposta foi avaliada no período entre 2010 e 2017, e os resultados mostraram que este sistema foi capaz de extrair informações mais generalizadas que demais modelos até então e bons resultados financeiros. Com base na informação da tendência, foi realizada uma avaliação financeira que demonstrou resultados superiores à estratégia BH. Este trabalho destaca a capacidade de redes do tipo CNN em aprender e identificar padrões em séries temporais que possam identificar situações de compra e venda e auxiliar em operações no mercado financeiro.</p>
        <p>Hoseinzade e Haratizadeh (2019) sugeriram duas abordagens utilizando CNN para pre-ver o preço de um dia futuro para o mercado de ações com base em indicadores técnicos e variáveis macroeconômicas. Estes modelos eram respectivamente CNNs 2D e 3D. A proposta era conseguir combinar dados de diversos mercados a fim de encontrar correlações entre eles para uma melhor previsão. Os modelos foram testados principalmente nos mercados S&P, Nasdaq e Dow Jones. Os resultados indicam que as CNNs são capazes de indicar a tendência futura do mercado como uma abordagem de classificação e que a combinação com dados de outros mercados pode auxiliar na previsão. Este trabalho demonstra que um modelo CNN pode ser usado para classificar séries temporais no mercado financeiro.</p>
        <p>Pimenta et al. (2018) também realizaram pesquisa aplicada ao mercado de ações brasileiro. Fora empregados 11 indicadores técnicos subdivididos em osciladores, seguidores de tendência, sistemas de bandas e identificadores de divergências, treinando um modelo de Algoritmo Genético (AG) para aprender a direção das ações da Bolsa de Valores do Estado de São Paulo (BOVESPA). Além disso foi utilizada técnica de seleção de recursos para encontrar correlações entre indicadores e o movimento dos preços. Dentre os indicadores selecionados estão RSI, W%R. Os resultados apresentaram boa acurácia da predição da direção da tendência, e superando expressivamente a estratégia BH em termos de retorno sobre investimento. Este trabalho evidencia que o uso de indicadores para realização previsão no mercado financeiro pode proporcionar resultados superiores às estratégias mais comuns de investimento.</p>
        <p>Além disso, outros pesquisadores implementaram métodos de AP com base no reconhecimento de imagens. Velay e Daniel (2018) usaram CNN e LSTM para reconhecer padrões de gráficos comuns na análise técnica (BULKOWSKI, 2011). O objetivo era automatizar a detecção de tais padrões na tentativa de ajudar na tomada de decisão e fornecer uma previsão da movimentação dos preços no mercado de ações. O estudo utilizou os seguintes padrões: bandeiras de baixa e alta e topo e fundo duplos. Segundo os autores, o modelo LSTM alcançou a melhor taxa de revocação, chegando a 97% contra 73% da CNN.</p>
        <p>Tsai, Chen e Wang (2019) propuseram o uso de CNN combinando uma técnica conhecida como Gramian Angular Field (GAF), uma forma de representar série temporal em formato de imagens padronizadas, para classificação de padrões de gráficos. A arquitetura do sistema proposto é apresentada na Figura 3. O gráfico de Candlestick representa a série temporal dos preços. Cada série é submetida ao processamento do GAF gerando as imagens padronizadas para os preços de abertura, máxima, mínima e fechamento. As imagens então são utilizadas como entrada na rede para classificação. Esta é compostas por 2 camadas convolucionais que extraem padrões das imagens, e a classificação é feita por camadas totalmente conectadas. Esses padrões de Candlestick são comumente usados para encontrar pontos de virada na tendência dos preços das ações e podem indicar uma operação de compra/venda (BULKOWSKI, 2011). Foram utilizados 8 padrões neste trabalho, sendo estes: estrela da manhã/noite, engolfo baixa/alta, martelo e martelo invertido, estrela cadente e enforcado. Os resultados mostraram uma precisão de aproximadamente 88% para esta classificação, o que pode ser aplicável em operações no mercado financeiro a fim de encontrar pontos de virada na tendência de preços e obter retornos financeiros superiores, antecipando momentos de queda e recomprando quando indicar reversão de tendência.</p>
        <p>Em outro trabalho, Hiransha et al. (2018) fizeram a comparação entre 4 modelos de RNA: MLP, RNN, CNN e LSTM para predizer o índice da National Stock Exchange (NSE), uma bolsa de valores da Índia, cujo índice principal é o New York Stock Exchange (NYSE). Em sua pesquisa o modelo CNN apresentou melhores resultados em relação aos outros algoritmos pois foi capaz de reagir mais rapidamente às mudanças abruptas do índice, evidenciando sua melhor capacidade na identificação de padrões sobre os preços.</p>
        <p>Sezer e Ozbayoglu (2018) desenvolveram um sistema para negociação baseado em séries temporais usando uma abordagem de reconhecimento de imagem com CNN para classificar os melhores pontos de compra e venda. O sistema foi chamado Convolutional Neural Network - Technical Analysis (CNN-TA) e foi baseado no uso de 15 indicadores técnicos em 15 períodos subsequentes para gerar imagens em formato 2D de dimensões [15x15] que representam amostras diárias. A Figura 4 mostra a CNN utilizada na proposta. Esta é composta por 2 camadas convolucionais subsequentes e 1 de max-pooling, a fim de extrair padrões na matriz de entrada. São utilizados filtros bidimensionais de [3x3] nas camadas convolucionais e uma janela de pooling de [2x2]. Ao final a classificação é realizada por meio de camadas totalmente conectadas. Todas as camadas utilizam a função de ativação ReLU, e a camada de saída utiliza a função Softmax. No treinamento foram utilizados 2 Dropouts a fim de melhorar a generalização da rede.</p>
        <p>Cada imagem foi rotulada como compra, venda ou neutro, de acordo com um algoritmo de rotulagem baseado em janela deslizante. Os resultados foram comparados com a estratégia BH e outras estratégias de negociação por um longo período e indicam que o sistema CNN-TA conseguiu superar todas as estratégias de negociação comumente comparáveis. Desta forma, este trabalho evidencia que um modelo CNN pode ser utilizado para classificar momentos de operação no mercado financeiro.</p>
        <p>Zhang et al. (2019) utilizaram uma rede LSTM para previsões do preço de fechamento de ações. A abordagem foi construída de forma a minerar as distribuições de dados de uma determinada ação e gerar dados nas mesmas distribuições, onde uma rede Rede Adversarial Generativa (Generative Adversarial Network - GAN) junto de uma MLP discriminadora é empregada para diferenciar os dados reais dos dados gerados. O modelo LSTM foi responsável pela previsão do preço futuro. Os dados escolhidos para o estudo foram os valores diários do índice S&P 500 e diversas ações em uma larga faixa de dias de operação e tentou predizer o preço diário de fechamento. O sistema proposto superou os modelos de RNA comparados, que foram uma LSTM pura, uma MLP e uma SVM, mostrando que LSTM são aplicáveis para regressão sobre séries temporais de preços de ações.</p>
        <p>Alonso-Monsalve et al. (2020) desenvolveram um algoritmo híbrido chamado CLSTM que combina uma CNN para pré processar os dados de ações, sendo estes: preço e diversos indicadores técnicos. Em seguida, utilizou os resultados em uma rede LSTM para predizer o preço do próximo instante no tempo. Os autores compararam os resultados com uma rede LSTM pura, uma Rede Neural de Função Base Radial (Radial Basis Function Neural Network- RBFNN) e uma CNN pura. Como conclusão, afirmam que o algoritmo proposto demonstrou melhores resultados que utilizando os modelos comparados. Este trabalho demonstra que a combinação CNN-LSTM para regressão pode ser aplicável para predizer o preço futuro de ações, onde a CNN extrai padrões de comportamento sobre os preços e a LSTM utiliza tais padrões para prever o preço em um instante seguinte.</p>
        <p>Chung e Shin (2020) utilizaram CNN para previsão da flutuação dos índice de preços de ações da Coreia do Sul. Os parâmetros da rede foram otimizados utilizando AG. Os dados de entrada foram os dados históricos dos preços e volume financeiro negociado. O sistema proposto foi comparado com uma MLP. Segundo os autores, os resultados da proposta AG e CNN proposto superou os modelos de RNA comparados e demonstra a eficácia da abordagem híbrida de AG e CNN. Este trabalho reforça a capacidade da rede CNN em identificar padrões de mudanças em séries temporais.</p>
        <p>Mehtab e Sen (2020) utilizaram rede CNN para realizar previsão do índice do mercado financeiro da Índia (NIFTY) por um período de 4 anos, de 2015 a 2019. Foram feitos vários testes com diferentes parâmetros com o objetivo de realizar ajustes finos dos parâmetros da rede. Segundo os autores, os resultados indicam claramente que o sistema de previsão baseado em CNN é o mais eficaz e preciso para prever o movimento dos valores do índice NIFTY com um horizonte de previsão semanal,</p>
        <p>A Figura 5 apresenta um sumário dos trabalhos descritos neste capítulo. Os modelos mais comumente utilizados na literatura têm sido LSTM e CNN. As CNNs têm sido mais aplicadas para problemas de classificação e reconhecimento de padrões, enquanto as LSTMs têm sido a escolha preferida para regressão de séries temporais. Nota-se também que a maioria dos estudos têm sido realizados com ações, enquanto alguns expandiram as pesquisas para ETFs e índices de mercado.</p>
        <p>Um algoritmo de negociação preciso depende de muitas variáveis e um modelo CNN tem se mostrado capaz de representar um conjunto de indicadores de análise técnica e outras variáveis de entrada em forma de séries temporais a fim de classificar padrões para possíveis sinais de negociação ou identificar padrões que possam prever preços futuros. Além disso, os trabalhos mostram que a escolha dos indicadores técnicos financeiros pode ter grande influência no resultado do estudo e na capacidade dos modelos de RNA de realizaram previsão ou classificação. Analisando os trabalhos apresentados, pode-se concluir que aplicar modelos de AP utilizando indicadores técnicos financeiros pode servir como uma fonte de informação para tomada de decisão. As propostas mostram que RNAs são capazes de aprender tendências nos preços e extrair detalhes sobre o comportamento de cada ativo.</p>
    <h2>3 FUNDAMENTAÇÃO TEÓRICA</h2>
        <p>Este capítulo apresentará os conceitos básicos de estratégia de investimento, com maior foco na chamada Análise Técnica. Na sequência será apresentado um conceito de análise de série temporal baseado em estatística. Por fim as teorias sobre RNAs e modelos de AP serão abordados, os quais constituem a base deste trabalho.</p>
    <h2>3.1 ESTRATÉGIAS DE INVESTIMENTO</h2>
        <p>Tradicionalmente, dois métodos são utilizados para tomar decisão no mercado de ações: Análise Fundamentalista e Análise Técnica. O primeiro está interessado nos dados relacionados à empresa da respectiva ação, exigindo experiência na interpretação de dados financeiros, como balanços contábeis e fatores econômicos que interferem na empresa, bem como acompanhamento de notícias e fatos relevantes. A estratégia BH baseia-se em Análise Fundamentalista, selecionando empresas por meio da análise destes dados, deduzindo que as boas empresas continuarão a apresentar bons resultados e consequentemente o preço de suas ações aumentará ao longo do tempo. Por depender da interpretação de dados, uma abordagem de AP utilizando PLN é mais aplicável para este tipo de estratégia.</p>
        <p>Por outro lado, a Análise Técnica está interessada em lucrar na variação dos preços das ações, geralmente em um curto espaço de tempo. Pode-se definir a Análise Técnica como o estudo da ação do mercado, primariamente por meio de uso de gráficos, com o objetivo de prever comportamento ou tendências futuras (LEMOS, 2017).</p>
    <h2>3.1.1 ANÁLISE FUNDAMENTALISTA</h2>
        <p>Este tipo de estratégia busca investir em empresas do ponto de vista de seus resultados operacionais, tais como lucro financeiro e perspectiva de crescimento futuro. Segundo Damodaran e Cunha Serra (2000), há dezenas de modelos de avaliação de empresas, mas apenas duas abordagens: intrínseca e relativa. O valor intrínseco de um ativo é determinado pelos fluxos de caixa esperados durante a vida da empresa, ajustado pelo grau de incerteza por eles gerados. Um dos métodos mais utilizados para analisar empresas é o Fluxo de Caixa Descontado. Este é um método para avaliar a riqueza econômica de uma empresa dimensionada pelos retornos futuros esperados e descontados por uma taxa de atratividade que reflete o custo de oportunidade. Ou seja, o valor de um ativo representa o seu montante justo hoje, enquanto preço significa por quanto o mercado o está negociando na data atual. Sendo assim, se o preço praticado é inferior ao valor, tem-se um investimento em potencial (DAMODARAN; CUNHA SERRA, 2000).</p>
        <p>Já uma outra abordagem é conhecida como a Hipótese do Mercado Eficiente. Esta é uma teoria de investimento que fundamenta que os preços praticados no mercado sempre refletem todas as informações já conhecidas das empresas, bem como fatores que influenciam nas mesmas. Logo, segundo esta hipótese, não existem ações baratas ou caras, uma vez que o mercado eficiente sempre precifica a cotação de uma ação no seu valor justo (MALKIEL; FAMA, 1970).</p>
        <p>Dentro da hipótese há três níveis distintos de eficiência:</p>
        <ul>
            <li>Eficiência fraca: defende que o mercado é eficiente em refletir todas as informações públicas disponíveis. Os retornos no mercado são independentes. Desta forma, retornos passados não ajudam a prever retornos futuros;</li>
            <li>Eficiência semi-forte: além de sustentar a hipótese fraca, sugere que as novas informações são absorvidas pelo mercado instantaneamente. Logo, os investidores não conseguem resultados acima do mercado com informações conhecidas;</li>
            <li>Eficiência forte: além de englobar as duas hipóteses descritas anteriormente, sustenta que os preços dos ativos refletem instantaneamente todo o tipo de informação. Seja ela pública ou privada.</li>
        </ul>
        <p>Resumidamente, esta teoria afirma quer é impossível obter retornos acima do mercado, uma vez que os preços já refletem todas as informações relevantes para os resultados futuros. Isto significa que a ação vai ser sempre levada ao seu valor justo, fazendo com que seja impossível para os investidores comprarem ações desvalorizadas ou vender ações sobrevalorizadas para alcançar lucros significativos. Isto também é defendido pela teoria do Passeio Aleatório (Random Walk) (FAMA, 1995), que afirma que as variações nos preços das ações independem uma da outra. Esta teoria defende que não se pode olhar para os movimentos passados de uma ação, padrão ou tendência para prever os movimentos futuros do mercado. O mercado funciona de forma irracional, sendo os movimentos dos preços imprevisíveis, seguindo um "passeio aleatório". Com isso, uma análise que se baseia nos movimentos passados no mercado financeiro não é eficiente.</p>
    <h2>3.1.2 ANÁLISE TÉCNICA</h2>
        <p>A Análise Técnica acredita que é possível estimar o comportamento futuro do mercado analisando os históricos de preços anteriores. O objetivo é identificar oportunidades de negociação analisando tendências estatísticas e padrões gráficos com base no histórico de preços passados, uma vez que os movimentos dos preços são formados pela atuação de grandes investidores montando e desfazendo posições.</p>
        <p>A Análise Técnica tornou-se uma ferramenta incrivelmente popular entre investidores para medir a força do mercado e prever a direção de curto/médio prazo para os mercados e as ações individualmente (COLBY; MEYERS, 1988). Isto se deve ao fato de ser uma abordagem mais simplista para as pessoas que não possuem um vasto conhecimento em análise de empresas e querem focar apenas no lucro financeiro, principalmente de curto prazo.</p>
        <p>Os princípios da Análise Técnica podem ser descritos da seguinte forma (EDWARDS; BASSETTI; MAGEE, 2012; SHAN, 2012):</p>
        <ul>
            <li>As médias descontam tudo: pois estas refletem as atividades de investidores, incluindo aqueles possuidores de grandes previsões e melhores informações nas tendências dos eventos;</li>
            <li>Os preços se movem em tendências: o preço das ações se move em tendências, nas quais a mais importante é a tendência primária, de longo prazo. A segunda tendência é formada pelas correções que ocorrem em sentido contrário ao movimento primário. E a terceira é composta por tendências menores de curto prazo, dia a dia;</li>
            <li>A história se repete: os estudos apresentados por Dow consistem na crença de que os padrões identificados nas tendências e nas médias se repetem ao longo do tempo (SHAN, 2012).</li>
        </ul>
        <p>Para Elder (2018), o preço é o líder do mercado: ele é o consenso máximo entre todos os participantes sobre o valor de determinado ativo. Na Análise Técnica, esses preços variam em tendências de alta ou de baixa e essa tendência só muda de fato com uma mudança de volume das negociações. Tais tendências podem ser observadas por meio de gráficos de Candlestick, onde cada Vela (Candle) representa a variação do preço em um determinado intervalo de tempo. Desta forma, padrões de gráficos de Candlestick (EDWARDS; BASSETTI; MAGEE, 2012)35 são utilizados com o objetivo encontrar regiões de interesse no preço e momentos para realizar compras e vendas baseando-se no histórico de preços passados.</p>
    <h2>3.1.3 INDICADORES TÉCNICOS</h2>
        <p>Ao longo dos anos, com base em análises estatísticas, foram sendo desenvolvidas ferramentas para auxiliar na análise das tendência do mercado, os chamados indicadores técnicos. Vários indicadores técnicos foram desenvolvidos com o objetivo de indicar a operação mais rentável para o momento usando dados, como volume financeiro negociado e preços passados. Os indicadores são fórmulas matemáticas utilizadas para alertar que um comportamento tem probabilidade de ocorrer, confirmar as informações fornecidas por outros indicadores ou mesmo prever um comportamento futuro de uma série histórica do ativo. De acordo com Colby e Meyers (1988), pode-se classificar os indicadores nas seguintes categorias:</p>
        <ul>
            <li>Rastreadores de Tendências: a tendência é um valor central ou valor típico para uma distribuição de probabilidade (SILVA, 2009). A tendência dos preços no mercado de ações é verificada por meio do histórico de preços em um certo período. Por exemplo, pode-se verificar uma tendência de alta pela média aritmética do histórico de preços do ativo quando ela está ascendente. Os rastreadores de tendência são confiáveis durante períodos de tendência, porém não identificam nem o começo nem o fim das tendências perdendo, em média, um terço do comprimento total das tendências (SACHETIM, 2006);</li>
            <li>Osciladores: um oscilador é um indicador que flutua acima e abaixo de um centro, ou entre níveis preestabelecidos, sendo mais comum entre 0-100% (SACHETIM, 2006). Podem permanecer em níveis extremos, os pontos chamados de sobrecompra e sobrevenda. Possuem a característica de não sustentarem a mesma tendência por um longo período, por isso são denominados osciladores;</li>
            <li>Indicadores de Volatilidade: volatilidade é uma medida de dispersão dos preços de uma ação. Pode ser medida pela diferença entre o maior e o menor preço em um período, ou ainda pela variância. A variância expressa o quão longe, em geral, os seus valores se encontram do valor esperado. Serve para medir a intensidade e a frequência das oscilações nas cotações. A volatilidade pode ser utilizada como uma medida do risco;</li>
            <li>Indicadores de Volume: o volume de negociações ou de capital investido evidencia a força do mercado. É comumente utilizado para medir a força compradora ou a força vendedora. Quando existem variações de preço com volume crescente é sinal de consistência na variação do preço naquele sentido. Isso faz com que a reversão da tendência do preço seja mais difícil de ocorrer.</li>
        </ul>
        <p>Majoritariamente, os indicadores consistem em uma série de dados que são derivados pela aplicação de uma fórmula. Estes números são interpretados visualmente como uma indicação de compra, venda ou neutro. Geralmente, é utilizada uma combinação de padrões gráficos e indicadores técnicos para tomar decisões de operação mais refinadas. Algumas abordagens que motivaram este trabalho utilizaram um conjunto de indicadores técnicos e um modelo de AP para reconhecer padrões em séries temporais a fim de classificar a melhor operação de negociação naquele momento.</p>
        <p>Na figura 6 está representado o conjunto de indicadores selecionados para este trabalho juntamente com um gráfico de Candelstick (BULKOWSKI, 2011), de forma semelhante ao que é comumente utilizado pelas pessoas que operam no mercado financeiro. Este tipo de gráfico representa a variação de preços de um determinado ativo em uma unidade de tempo, no caso, diária. As fórmulas e interpretações dos respectivos indicadores técnicos são apresentadas na sequência.</p>
    <h2>3.1.3.1 Índice de Força Relativa (Relative Strength Index - RSI)</h2>
        <p>É um indicador de momento que mede a magnitude das recentes mudanças de preço para classificar como situação de sobrecompra ou sobrevenda. A interpretação tradicional deste indicador consiste em: se o valor do RSI estiver acima de 70 está sobrecomprado e abaixo de 30 está sobrevendido (WILDER, 1978). O cálculo é feito em 2 passos conforme descrito a seguir:</p>
        <p>As variáveis GanhoMédio e P erdaMédia representam a média de dias que fecharam positivos e negativos, respectivamente, no período informado, sendo este geralmente de 14. Isto assegura que se na última janela de tempo analisada os preços apenas subiram o indicador chega próximo a 100, e se apenas caíram se aproxima de 0. </p>
        <p>Uma vez que existam a quantidade dias de dados suficientes no histórico, o passo dois pode ser calculado conforme a Eq. (2):</p>
        <p>GanhoMédioAnterior e P erdaMédiaAnterior representam as mesmas médias mencionadas anteriormente considerando a partir do instante anterior ao atual.</p>
    <h2>3.1.3.2 Williams %R (WR)</h2>
        <p>Ou apenas W%R, este é um oscilador de inércia o qual reflete a alteração do preço de fechamento em relação ao valor mais alto para o período. O W%R oscila entre 0 e -100. A leitura de 0 a -20 é considerada como condição de sobrecompra, e de -80 a -100 considerada como sobrevendida. Geralmente é utilizado o período de 14 (WILLIAMS, 1998). A Eq (3) fornece a fórmula de cálculo do W%R.</p>
        <p>As variáveis MáximoPeríodo, MinimaPeríodo e FechamentoAtual representam preço máximo, mínimo e preço de fechamento atual, respectivamente.</p>
    <h2>3.1.3.3 Índice de Fluxo Monetário (Money Flow Index - MFI)</h2>
        <p>Este indicador combina preço e volume para medir a pressão de compra e venda. Os valores são positivos quando o preço aumenta, ou seja, quando há pressão compradora e negativo quando os preços caem, o que indica pressão vendedora. Isto ocorre quando o Preço Típico (Typical Price) (TP) cresce ou cai. É geralmente aplicado para identificar reversões e extremos sendo utilizado para identificar sinais de sobrecompra e sobrevenda (QUONG; SOUDACK, 1989). O processo de cálculo é feito em 4 etapas, conforme descrito a seguir, onde i representa o período de cálculo, geralmente de 14: </p>
        <p>Preço Típico - Typical Price (TP):</p>
        <p>Fluxo Monetário Bruto - Raw Money Flow (RMF):</p>
        <p>Taxa de fluxo monetário - Money Flow Ratio (MFR):</p>
    <h2>3.1.3.4 Índice de Canal de Mercadoria (Commodity Channel Index - CCI)</h2>
        <p>Um indicador de momento usado para identificar o início de uma nova tendência ou avisar sobre condições extremas (sobrecompra e sobrevenda). Para isto, este indicador mede a correlação entre o preço atual e a média dos preços do período (LAMBERT, 1983). Sua fórmula é apresentada na Eq. (8):</p>
        <p>A variável T P é calculada com a mesma fórmula utilizada no MFI. SMA, do inglês Simple Moving Average, consiste em uma média móvel de preços típicos do período.</p>
    <h2>3.2 Série Estacionária</h2>
        <p>Os preços das ações são altamente voláteis, no entanto, na maioria das vezes os preços seguem uma tendência de alta ao longo do tempo. Em outras palavras, o valor médio dos preços aumenta com o tempo, e é por isso que a estratégia BH é a estratégia de investimento preferida por muitos investidores.</p>
        <p>Uma série temporal é dita estacionária quando ela se desenvolve ao longo do tempo ao redor de uma média constante, refletindo alguma forma de equilíbrio estável. Isso significa que propriedades estatísticas como média ou desvio padrão, não são significativas para os preços no longo prazo (SILVEIRA BUENO, 2008).</p>
        <p>Para capturar padrões de séries temporais invariantes ao efeito temporal, como nas ações, pode-se utilizar o preço de forma estacionária. Dessa forma, torna-se mais fácil de prever o seu comportamento: basta deduzir que suas propriedades estatísticas serão as mesmas no futuro, como no passado.</p>
        <p>Segundo Lee, Lee e Lee (2010), em um estudo aplicado a ações buscando encontrar evidências que os preços apresentam comportamento estacionário, este concluiu que a série de preços de ações apresenta estacionariedade em mercados financeiros de 32 países desenvolvidos e 26 em desenvolvimento. Assim, os índices reais de preços de ações são processos estacionários que são inconsistentes com a Hipótese de Mercado Eficiente. Isso mostra a presença de oportunidades lucrativas e de arbitragem entre os mercados de ações.</p>
        <p>O Preço de Fechamento Estacionário (PFE) pode ser calculado utilizando o método da primeira diferença. Este método de diferenciação consiste em calcular a diferença do preço no período T com o valor do período anterior T −1. Ao se fazer a primeira diferenciação, retira-se o efeito acumulado da série e mostra-se apenas a variação do período T contra o período T - 1 ao longo de toda a série.</p>
        <p>Em seguida, para utilizar estes valores como entrada, pode-se utilizar uma função de normalização, como a Tangente Hiperbólica (TanH). Como resultado, é obtida a média do preço de fechamento em torno do ponto zero, como mostra a Figura 7</p>
    <h2>Redes Neurais Artificiais (RNA)</h2>
        <p>As pesquisas em Redes Neurais Artificiais (RNA)s iniciaram-se com a proposta de McCulloch e Pitts (1943) em um estudo sobre o comportamento do neurônio biológico a fim de criar um modelo matemático que pudesse representá-lo. Este modelo inicialmente proposto era capaz de separar entradas de forma binária.</p>
        <p>O neurônio artificial é um modelo matemático que busca simular comportamento e funções do neurônio biológico. Dessa forma, os dendritos são substituídos pelas entradas, cujas ligações com o corpo celular são realizadas através dos pesos, simulando as sinapses neurais. Os estímulos são captados pelas entradas e processados no corpo celular pela função de soma ponderada das entradas e o bias.</p>
        <p>O limiar de disparo do neurônio biológico é substituído pela função de ativação, e o resultado deste processo é repassado para a sequência da rede, substituindo o axônio biológico (RUSSELL; NORVIG, 2002). A Figura 8 exibe a representação do neurônio artificial de McCulloch e Pitts (1943).</p>
        <p>Pode-se matematicamente definir a saída do neurônio de McCulloch e Pitts (1943) pela onde:</p>
        <ul>
            <li>xj representa os sinais de entrada;</li>
            <li>Wij representa os pesos associados às entradas. Estas entradas são multiplicadas por seus respectivos pesos, podendo gerar valores positivos (excitatórios) ou negativos (inibitórios);</li>
            <li>b representa o bias do neurônio;</li>
            <li>∑︁ representa o somatório dos sinais calculados pelos produtos das entradas por seus pesos;</li>
            <li>f representa a função de ativação;</li>
            <li>yi representam a saída calculada do neurônio artificial i.</li>
        </ul>
        <p>Dentre as principais funções de ativação utilizadas estão:</p>
        <ul>
            <li>Função Sigmóide: esta função, representada pela Eq. (10), com o comportamento gráfico da Figura 9, pode assumir valores entre 0 e 1;</li>
            <li>Função Tangente Hiperbólica (TanH): esta função, representada pela Eq. (11), com o comportamento gráfico da Figura 10, pode assumir valores entre -1 e 1;</li>
        </ul>
        <p>Uma RNA é uma arquitetura composta por uma grande quantidade de neurônios artificiais (NIGRIN, 1993), formando um sistema paralelo e distribuído (HAYKIN, S.S., 1999). O neurônio artificial é a unidade de processamento básica de uma RNA. Em uma RNA, os neurônios são dispostos em uma ou mais camadas e interligados por um certo número de conexões (pesos), geralmente unidirecionais. Estas conexões armazenam o conhecimento representado no modelo e ponderam a entrada recebida por cada neurônio da rede através de uma função matemática (BRAGA, 2000).</p>
        <p>A topologia de uma RNA é definida pelo número de camadas, de neurônios, grau de conectividade entre os neurônios e funções de ativação. Além disso, as redes podem possuir conexões de retroalimentação, nas quais o neurônio pode receber a saída de outros da mesma camada (ou posteriores) ou de si próprio. O paralelismo é uma das principais características de uma RNA, uma vez que este cria a possibilidade de desempenho superior em relação aos modelos algorítmicos da área de inteligência artificial clássica (HAYKIN, S.S., 1999).</p>
        <p>As principais aplicações de RNAs podem ser divididas da seguinte forma:</p>
        <ul>
            <li>Classificação, devido à capacidade de abstração e generalização de conhecimento;</li>
            <li>Aproximação de funções ou análise de regressão, incluindo a previsão de séries temporais;</li>
            <li>Processamento de dados, incluindo filtragem e agrupamento.</li>
        </ul>
        <p>A classificação é uma tarefa que consiste em dividir os dados em classes predefinidas. Pode ser um problema de classificação binário, onde existem apenas duas classes, ou multiclasses, onde existem três ou mais classes. Já a tarefa de regressão consiste em estimar o valor futuro de uma série baseando-se em dados e comportamentos históricos. Agrupamento de dados consiste na tarefa de computar funções a fim de separar dados que possuam características semelhantes.</p>
    <h2>Rede Neural Feedforward</h2>
        <p>As redes feedforward são a base para muitos modelos de RNAs que têm sido propostos aos longo dos anos. Para Kriesel (2007), a saída de uma rede feedforward, para qualquer entrada, é calculada passando o sinal, a partir da camada de entrada até a camada de saída, somente uma vez, ou seja, cada neurônio em uma camada possui conexão direta, somente, com os neurônios da próxima camada.</p>
        <p>A publicação inicial de McCulloch e Pitts (1943) consiste na base deste tipo de RNA, e Hebb (1949) propôs um modelo básico de auto-organização para tal rede. Na sequência Rosenblatt (1958) desenvolveu o modelo Perceptron, o primeiro capaz de realizar o aprendizado supervisionado.</p>
        <p>Para que uma RNA seja capaz de realizar inferências sobre os dados, é necessário que a mesma seja treinada. Segundo S. Haykin (2007) o aprendizado de uma RNA consiste em um processo pelo qual os parâmetros de uma rede neural são adaptados através de um processo contínuo de estimulação pelo ambiente no qual a rede está inserida. Este processo pode ser classificado como:</p>
        <ul>
            <li>Aprendizado Supervisionado: um conjunto de dados é apresentado como entrada para a rede e, associado a este conjunto de entrada, é apresentado um conjunto de saída esperada. O algoritmo de aprendizado busca ajustar os pesos das conexões entre os neurônios de tal forma que, para dada uma entrada, a rede seja capaz de calcular uma saída o mais próximo possível da saída desejada;</li>
            <li>Aprendizado Não Supervisionado: neste tipo de treinamento é utilizado apenas as informações das entradas e realiza-se o aprendizado através de agrupamentos de dados e conceitos de vizinhança. Muito utilizado para encontrar padrões entre os dados cujas estruturas não sejam bem conhecidas.</li>
        </ul>
    <h2>Multilayer Perceptron (MLP)</h2>
        <p>A rede Multilayer Perceptron (MLP) representa uma generalização do Perceptron proposto por Rosenblatt (1958). Sua arquitetura consiste em várias camadas compostas por neurônios artificiais onde cada neurônio de uma camada possui ligação com todos os neurônios da camada seguinte.</p>
        <p>A camada de entrada recebe os dados, realiza as sinapses e repassa o sinal para a camada seguinte, e assim sucessivamente até a camada de saída. Neste modelo podem haver uma ou mais camadas intermediárias, que é onde a maior parte do processamento é realizada. Não existem conexões entre a saída de um neurônio e algum outro neurônio localizado em uma camada anterior, o que significa que esta é uma arquitetura de rede feedforward. A Figura 11 apresenta a arquitetura de uma rede MLP como exemplo. </p>
        <p>Para que este modelo seja capaz de representar o conhecimento adquirido, é necessário realizar ajustes nos pesos de ligação entre os neurônios. Durante o treinamento, a informação inicial flui para a frente através da rede até a camada de saída. Isso é chamado de propagação direta. Para se realizar os ajustes dos pesos utiliza-se um algoritmo chamado Retropropagação, proposto por Rumelhart, Hinton e Williams. Este algoritmo busca retropropagar o erro entre a saída desejada e a saída obtida visando calcular o gradiente a fim de minimizar o erro total da rede, no decorrer do treinamento.</p>
        <p>Para realizar ajustes a fim de melhorar o aprendizado da rede, há alguns parâmetros que merecem atenção:</p>
        <ul>
            <li>Taxa de aprendizagem: taxas de aprendizagem altas implicam em mudanças maiores nos pesos. Deve-se buscar um meio termo para evitar grandes oscilações e garantir um treinamento em tempo adequado;</li>
            <li>Quantidade de épocas: indica a quantidade de vezes que o conjunto de dados deve ser apresentado à rede durante o treinamento. Uma maior quantidade de épocas implica em um maior aprendizado por parte da rede para aquele conjunto de dados, porém reduz a capacidade de generalização da rede;</li>
            <li>Tamanho de lote: define o número de exemplos de treinamento usados em uma época. Lotes maiores proporcionam treinamento mais rápido, entretanto isto pode causar uma generalização deficiente para problemas mais complexos;</li>
            <li>Quantidade de camadas: deve-se tomar cuidado, pois é nestas camadas que os mapeamentos não lineares entre entradas e saídas são processados. Um grande número de camadas pode causar o problema de desvanecimento do gradiente, impossibilitando da rede aprender.</li>
        </ul>
    <h2>Rede de Memória de Curto Longo Prazo (LSTM)</h2>
        <p>Rede Neural Recorrente (RNN) é um tipo de RNA especializada em reconhecimento de dados sequenciais, como séries temporais. Uma de suas principais vantagens nesta tarefa, é o reconhecimento de longas cadeias de sequências, as quais seriam de difícil reconhecimento em redes não especializadas no reconhecimento deste tipo de dados.</p>
        <p>A decisão de uma RNN na etapa de tempo t − 1 afeta a decisão que alcançará um momento mais tarde na etapa de tempo t. Assim, as redes recorrentes têm duas fontes de entrada, o presente e o passado recente, que se combinam para determinar como respondem a novos dados. Todos os modelos compartilham a necessidade de relembrar entradas e saídas passadas para predizer o próximo estado das redes e adaptar a si mesmos.</p>
        <p>O modelo de rede LSTM foi proposto inicialmente por Hochreiter e Schmidhuber, este consiste em um tipo especial de RNN capaz de aprender conexões de longo prazo, ou seja, esta rede é capaz de memorizar valores, sendo bem adequada para prever séries temporais com intervalos de tempo de duração desconhecido. Além disso, a ideia deste modelo foi concebida na busca de resolver o problema de explosão ou desvanecimento do gradiente em RNNs.</p>
        <p>Uma de suas principais características em relação a outros modelos de RNN foi a inclusão de unidades especiais conhecidas como portões (gates). Essas unidades calculam os pesos que os conectam de forma a evitar o desvanecimento do gradiente.</p>
        <p>Como toda RNN, as LSTMs têm a capacidade tanto de lembrar quanto de esquecer o estado anterior quando essa informação não for mais necessária. Ao logo do tempo de treinamento, a rede tem a capacidade de aprender o que esquecer exatamente, mecanismo que é executado através dos parâmetros do forget gate.</p>
        <p>Dessa forma, os valores do estado anterior, a memória atual e a entrada são combinadas para formar a saída da unidade (ou célula), mecanismo que se mostrou bastante eficiente no aprendizado de longas dependências dos termos de uma sequência. A Figura 12 ilustra os principais elementos que estruturam uma célula LSTM.</p>
        <p>O modelo LSTM foi desenvolvido há mais de duas décadas, mas até hoje é muito utilizado graças à expansão da capacidade computacional, a qual que era um empecilho até alguns anos atrás para as técnicas de AP.</p>
    <h2>Rede Neural Convolucional (CNN)</h2>
        <p>LeCun et al. introduziu as CNNs em um trabalho aplicado a um conjunto de dados para reconhecimento de letras manuscritas. Este modelo é inspirado no córtex visual dos animais e consiste em um tipo especializado de RNA para processamento de dados que possuem uma topologia conhecida como forma de grade, sendo os exemplos mais comuns dados como imagem ou séries temporais. Diversas abordagens baseadas em CNN têm sido desenvolvidas, tais como: AlexNet, GoogLeNet, Inception e ResNet.</p>
        <p>Uma CNN básica é representada na Figura 13. Esta é composta por camadas convolucionais, funções de ativação, camadas de pooling e camadas totalmente conectadas, as quais serão detalhadas na sequência. Em uma primeira etapa ocorre a extração de recursos da imagem de entrada e na sequência as informações aprendidas são utilizadas para classificação.</p>
    <h2>Camada convolucional</h2>
        <p>A camada convolucional é utilizada para encontrar padrões nos dados de entrada, como borda, forma ou cor em uma imagem. Esta camada substitui a multiplicação de matrizes típica das RNAs Feedforward, como a MLP, pela operação de convolução. Matematicamente a convolução de duas funções f e g é uma função h, que recebe um parâmetro x, para um deslocamento y, dada pela Eq.(12).</p>
        <p>Na prática, este processo é realizado utilizando uma matriz, conhecida como filtro convolucional (também chamada de kernel), que é multiplicada, passo a passo (parâmetro chamado stride que define o tamanho do passo), pela matriz de entrada, resultando em um mapa de convolução como saída.</p>
        <p>As redes CNN possuem algumas características que as diferenciam de modelos mais simples, como as redes MLPs por exemplo. Dentre estas características pode-se citar:</p>
        <ul>
            <li>Conectividade esparsa: este tipo de conectividade acontece devido ao fato de que o filtro que é utilizado no processo de convolução apresenta dimensões muito menores do que a matriz de entrada. Isto permite uma correlação espacial local através da aplicação de um padrão de conectividade local entre neurônios de camadas adjacentes. Na Figura 14 é possível verificar os dois tipos de conectividades (global e esparsa) para os dois tipos de arquiteturas (MLP e CNN). Observando a entrada x3 é possível verificar que quando o modelo faz uso da multiplicação de matrizes (conectividade global - MLP) todas as unidades de saída (N1 a N5) são afetadas pela entrada x3. Isto não ocorre quando o modelo faz uso da camada convolucional, neste caso utilizando um filtro de tamanho 3 por exemplo, apenas três unidades da camada de saída (N2, N3 e N4) são afetadas pela entrada x3. Ao processar uma imagem, a entrada pode ter milhares pixels, mas é possível detectar pequenas recursos significativos, como arestas, com filtros que ocupam apenas dezenas pixels. Isso significa que é necessário armazenar menos parâmetros, o que reduz o requisitos de memória do modelo e melhora sua eficiência estatística.</li>
            <li>Campos receptivos locais: cada região na matriz de entrada que representa o tamanho do filtro utilizado corresponde a um único neurônio na camada escondida. Cada deslocamento do filtro ao longo da matriz de entrada é representado por um novo neurônio na camada escondida. Este processo pode ser visualizado na Figura 15. Em um primeiro momento, o resultado do filtro de formato [3x3] é representado pelo neurônio N1 da camada escondida. A região destacada em preto na matriz de entrada representa o campo receptivo local do neurônio de saída N1. Avança-se um passo no processo de convolução, e a nova posição do filtro é representada pelo neurônio N2.</li>
            <li>Compartilhamento de parâmetros: em uma rede MLP, cada elemento da matriz de peso é usado exatamente uma vez ao calcular a saída de uma camada. Na CNN, cada membro do filtro é usado em todas as posições da entrada. Isto faz com que os padrões que ocorrem com frequência na matriz de entrada e que estejam localizados em qualquer parte da entrada possam ser aprendidos e em vez de aprender um conjunto separado de parâmetros para cada local, aprende-se apenas um conjunto buscado nos dados de entrada. Isto reduz o número total de parâmetros treináveis e a quantidade de multiplicações realizadas. Na Figura 16 pode ser visualizado como acontece o compartilhamento de parâmetros nas camadas convolucionais. As setas pretas indicam as conexões que usam um determinado parâmetro em dois neurônios diferentes. Na camada convolucional as setas pretas indicam os usos do elemento central de um filtro de 3 elementos. Devido ao compartilhamento de parâmetros, este parâmetro único é usado em todos os locais de entrada. Já na camada totalmente conectada (semelhante a uma rede MLP), a única seta preta indica o uso do elemento central da matriz de peso.</li>
            <li>Representação equivariante: o compartilhamento de parâmetros faz com que a camada convolucional possa ter uma propriedade chamada equivariância à translação. Isto significa que uma função é equivariante significa que se a entrada muda, a saída muda da mesma maneira, ou seja, uma função f(x) é equivariante a uma função g se f(g(x)) = g(f(x)). Ao processar dados de série temporal, isso significa essa convolução produz uma espécie de linha do tempo que mostra quando diferentes características aparecem na entrada. Ao mover-se um evento mais tarde na entrada, a mesma representação do mesmo aparecerá na saída, logo mais tarde. Similarmente com imagens, a convolução cria um mapa 2-D de onde certos recursos aparecem na entrada. Caso mova-se o objeto na entrada, sua representação moverá a mesma quantidade na saída.</li>
        </ul>
        <p>O filtro é formado por pesos que geralmente são inicializados utilizando algum método de distribuição aleatória e são atualizados a cada nova entrada durante o processo de Retropropagação. Os métodos de inicialização mais utilizados são os propostos por Glorot e Bengio e He et al.. Ambos os métodos têm por objetivo uma inicialização que busca distribuir o gradiente de forma semelhante ao longo das camadas da rede inicializando os pesos tendo em mente o tamanho da camada anterior, o que ajuda a atingir um mínimo global da função de custo de forma mais rápida e eficiente.</p>
        <p>Estes filtros são responsáveis por destacarem detalhes marcantes nos dados de entrada. Em uma imagem por exemplo, bordas e formas podem ser ressaltadas pelos filtros no processo de convolução. Isto permite que a rede demande um nível mínimo de pré-processamento quando comparada a outros algoritmos de classificação de imagens. A Figura 17 representa o processo de convolução em uma matriz.</p>
        <p>Para dados de entrada tridimensionais, como imagens RGB, o processo de convolução é realizado em cada canal e os resultados são somados, resultando no mapa de convolução do filtro específico. À medida que o filtro se desloca, através da entrada, é calculado o produto entre os pesos do filtro e os pixels correspondentes da entrada. Sendo assim, para dados de entrada com apenas 1 canal, pode-se matematicamente descrever o processo de convolução da CNN pela Eq (13). onde:</p>
        <ul>
            <li>I representa uma matriz como entrada;</li>
            <li>K um filtro (kernel) convolucional bidimensional que passeia sobre a matriz I;</li>
            <li>h representa a altura da matriz I;</li>
            <li>w representa a largura da matriz I;</li>
            <li>b representa o bias da camada convolucional;</li>
        </ul>
        <p>Dessa forma, o valor de cada pixel com posição (x, y) da nova imagem c é obtido mediante à somatória do produto dos pesos do filtro K pelos valores dos pixels correspondentes à posição do filtro na imagem de entrada I. Através das iterações durante o processo de treinamento, a rede vai aprender os pesos dos filtros, que vão se ativar quando virem algum tipo específico de característica em alguma posição espacial nos dados de entrada.</p>
        <p>O resultado deste processo gera os mapas de características. Este mapa consiste em um conjunto de dados gerados pela extração de um determinado filtro sobre a entrada durante a convolução e quantifica a presença da característica buscada. Na Figura 18 são mostrados os mapas de características gerados por 96 filtros aprendidos na primeira camada de convolução da proposta no trabalho de Krizhevsky, Sutskever e Hinton.</p>
        <p>Além disso, uma função de ativação é usada no final do processo de convolução para fornecer normalização dos dados. As funções mais comumente utilizadas são: Rectified Linear Unit (ReLU), Sigmoid, Tangente Hiperbólica (TanH) e Softmax. Dentre estas quatro funções de ativação, a ReLU é a mais conhecida pois resolve o problema de desvanecimento do gradiente e problemas de esparsidade.</p>
        <ul>
            <li>Função ReLU: esta função retorna 0 se receber qualquer entrada de valor negativo, e para qualquer valor positivo é retornado o próprio valor de volta. A Eq. (14) representa a função, com o comportamento no gráfico da Figura 19;</li>
            <li>Função Softmax: esta função tem por objetivo forçar a saída de uma RNA a representar a probabilidade dos dados serem de uma das classes definidas. Utilizando demais funções, a saída seria um simples valor numérico onde o maior indica a classe vencedora. A Eq.(15) apresenta a fórmula desta função: onde i representa o índice do neurônio de saída sendo calculado, j representa os índices de todos os neurônios de uma camada e z os valores do vetor de saída.</li>
        </ul>
    <h2>Camada de pooling</h2>
        <p>A camada de pooling é usada para obter invariância às transformações da imagem e representações mais compactas dos dados, reduzindo a dimensão da matriz e preservando os recursos extraídos da imagem, além disso esta sumarização de dados serve para diminuir a quantidade de pesos a serem aprendidos pela rede. Uma camada de pooling recebe cada saída do mapa de características da camada convolucional e prepara um mapa de características condensadas. Esta operação envolve deslizar um filtro bidimensional sobre cada canal do mapa de recursos e resumir os recursos situados na região coberta pelo filtro Os tipos de operação de pooling existentes são:</p>
        <ul>
            <li>maximium pooling: também chamado de pooling máximo ou max-pooling, este tipo seleciona o maior valor na área do kernel;</li>
            <li>average pooling: mantém o valor médio dos valores que aparecem no filtro;</li>
            <li>minimium pooling: semelhante ao maximium pooling, neste tipo o valor mínimo é armazenado em vez do máximo;</li>
        </ul>
        <p>A Figura 20 apresenta o processo de max-pooling com pool-size (dimensões do filtro de pooling) de [2x2] em uma matriz [4x4]. Essencialmente, neste tipo de operação, a matriz tem seu tamanho reduzido pela metade.</p>
        <p>Com isso, diversos mapas de características podem ser criados, contendo diversas características específicas. O resultado do uso de uma camada de pooling são mapas de características amostrados ou agrupados em uma versão resumida dos recursos detectados na entrada. Sendo assim, pequenas mudanças na localização do padrão na entrada detectada pela camada convolucional resultarão em um mapa de recurso agrupado com o recurso no mesmo local.</p>
    <h2>Dropout</h2>
        <p>As RNAs profundas possuem múltiplas camadas escondidas não lineares, as quais as tornam modelos capazes de aprender relações complexas entre entradas e saídas. No entanto, é comum que os dados apresentem desvios causados por erros de medição ou fatores aleatórios, de modo que existirão no conjunto de treino, mas não em dados de teste reais.</p>
        <p>Ademais, quando conjunto de dados de treinamento é pequeno ou limitado a rede pode se ajustar demasiadamente, de modo que será especializada em reconhecer somente os padrões com os quais foi treinada e não vai conseguir uma boa generalização. Este caso é chamado de overfitting, ou sobreajuste. Um modelo sobreajustado apresenta alta precisão quando testado com seu conjunto de dados de treinamento, porém não capaz de fazer uma boa representação da realidade.</p>
        <p>O Dropout é uma técnica para solucionar o problema de sobreajuste dos pesos da RNA. A ideia principal é desativar a ligação de neurônios da RNA aleatoriamente durante o treinamento para evitar mínimos locais e ajudar o algoritmo de aprendizado a convergir para um modelo mais generalizado e capaz de classificar dados futuros não rotulados.</p>
        <p>A Figura 21 representa este conceito. No modelo (a) é apresentada uma rede com todas as camadas interconectadas. No modelo (b) a representação do Dropout aplicada em determinado instante. A cada entrada durante o treinamento, uma unidade pode ser removida temporariamente da rede de forma aleatória juntamente com todas as suas conexões de entrada e saída.</p>
    <h2>Camadas totalmente conectadas</h2>
        <p>Por último, as camadas finais de uma CNN são geralmente compostas por camadas de rede totalmente conectadas, normalmente uma rede MLP, utilizada para executar a classificação dos dados.</p>
        <p>Na literatura também podem ser encontradas abordagens que utilizam outras redes conectadas ao final, tais como a proposto de Jain, Gupta e Moghe (2018), o qual utilizou uma camada LSTM antes da saída da rede para realizar regressão.</p>
    <h2>Retropropagação na CNN</h2>
        <p>Uma das diferença do processo de retropropagação das redes CNN para redes MLP é que a passagem do erro para trás durante a retropropagação também usa convolução. O processo de cálculo dos gradientes será detalhado na sequência.</p>
        <p>Formalmente, segundo Goodfellow, Bengio e Courville o processo de convolução se dá pela Eq. (16), onde usa-se o filtro rotacionado em 180 graus, no sentido de que conforme o valor de m aumenta, o índice na entrada aumenta, mas o índice no filtro diminui:</p>
        <p>Entretanto, o cálculo mais comumente utilizado no processo de propagação das camadas convolucionais é o descrito na Eq. (13), que é formalmente chamado de correlação cruzada, mas é comum usar-se o nome de convolução.</p>
        <p>A Figura 22 representa um neurônio convolucional, onde X uma imagem de entrada, F representa o filtro convolucional e O a saída do processo de convolução. Figura 22 - Representação do neurônio convolucional</p>
        <p>Sendo ___ e ___ os gradientes locais e ___ o erro da camada anterior no processo de retropropagação que deve ser repassado para a camada seguinte, deve-se calcular ___ e ___.</p>
        <p>Primeiro será abordado o cálculo de ___. O e F são matrizes, e ___ é o gradiente local da saída ___ e relaçao ao filtro ___. Isto significa que deve-se primeiro diferenciar a matriz O em relação à uma matriz ___. Na Eq. (17) tem-se como exemplo a posição [1, 1] da matriz ___: E as derivadas em respeito a F11, F12, F21 e F22 são:</p>
        <p>Isto significa que ___ será uma derivada parcial da matriz O em relação à matriz F. Usando a regra da cadeia, para cada elemento de F, calcula-se:</p>
        <p>Como exemplo, para a posição [1, 1] tem-se:</p>
        <p>Desta forma, chega-se à conclusão que este processo representa a correlação cruzada entre a entrada X e o gradiente do erro da próxima camada ___, conforme representado na Figura 23</p>
        <p>Semelhantemente, após o processo de diferenciação para a posição [1, 1], com base na</p>
        <p>Eq. (17), as derivadas em respeito a X11, X12, X21 e X22 são:</p>
        <p>O cálculo de ___ pode ser representado pela Eq. (22): E como exemplo, para as posições ___, ___ e ___</p>
        <p>Para obter os gradientes da matriz de entrada ___ , é necessário rotacionar o filtro F em 180 graus e calcular a convolução completa do filtro pelos gradientes da saída em relação ao erro ___, conforme representado na Figura 24.</p>
        <p>Em suma, ___ consiste em uma correlação cruzada entre uma entrada X e o gradiente de erro ___. E para calcular ___ , é realizada uma convolução entre um filtro F rotacionado em 180 graus e o gradiente de erro ___. Para calcular os gradientes das camadas de pooling os gradientes podem ser calculados seguindo o mesmo procedimento de usar a regra da cadeia de derivadas.</p>
    <h2>Método de otimização</h2>
        <p>Os algoritmos de aprendizagem profunda exigem otimização em muitos contextos, por exemplo, a realização da inferência e retropropagação nas CNN implica a resolução de um problema de otimização. O treinamento da rede é uma questão importante e que a depender da metodologia adotada, pode envolver alto custo computacional. Diversas técnicas de otimização foram desenvolvidas para resolver tal problema.</p>
        <p>O treinamento é feito utilizando o algoritmo de retropropagação proposto por Rumelhart, Hinton e Williams. O termo retropropagação é muitas vezes mal interpretado como o único algoritmo responsável pela aprendizagem dos pesos das redes neurais multicamadas. Na verdade, este somente se refere ao método para calcular o gradiente, enquanto outro algoritmo é responsável pela aprendizagem utilizando este gradiente, também chamado de método de otimização.</p>
        <p>Neste trabalho foi utilizado o método de otimização Adam. Este consiste em um método de otimização de funções objetivas estocásticas, calculando taxa de aprendizagem adaptativa individualmente para cada parâmetro a partir de estimativas do primeiro e segundo momentos dos gradientes. O algoritmo calcula uma média móvel exponencial do gradiente e do gradiente quadrado e os parâmetros β1 e β2 controlam as taxas de decaimento dessas médias móveis. O seu nome deriva de adaptive moment estimation, que significa estimação de momento adaptativo. Este método combina vantagens de dois métodos, o Ada-Grad e o RMSprop.</p>
        <p>A seguir, são apresentadas as equações de atualização, onde:</p>
        <ul>
            <li>α: taxa de aprendizado. A proporção em que as ponderações são atualizadas (valor padrão de 0,001). Valores maiores (por exemplo, 0,3) resultam em um aprendizado inicial mais rápido;</li>
            <li>β1: taxa de decaimento exponencial para as estimativas do primeiro momento (valor padrão de, 0,9);</li>
            <li>β2: taxa de decaimento exponencial para as estimativas do segundo momento (valor padrão de 0,999).</li>
            <li>∇L(Wt): é o gradiente da função de erro avaliada no vetor de pesos Wt</li>
            <li>mt: média móvel exponencial do gradiente;</li>
            <li>vt: o gradiente quadrado;</li>
            <li>ϵ: número com valor muito pequeno para evitar qualquer divisão por zero (valor padrão 10−8 ).</li>
        </ul>
        <li>Os autores deste método demonstraram sua eficácia aplicando o algoritmo no treinamento na base de dados do trabalho de LeCun et al. (1990). Dentre os benefícios deste algoritmo, os autores citam as seguintes características:</li>
        <ul>
            <li>Computacionalmente eficiente;</li>
            <li>Bem adequado para problemas grandes em termos de dados e/ou parâmetros;</li>
            <li>Apropriado para problemas com gradientes muito barulhentos/ou esparsos.</li>
        </ul>
        <p>Conforme mostrado na Figura 25, os autores demonstram que a convergência atende às expectativas da análise teórica frente a outros algoritmos já existentes.</p>
    <h2>3.3.4.7 Inicialização de pesos</h2>
        <p>A inicialização dos pesos da rede é crucial para uma boa convergência em uma quantidade de tempo razoável. Se os valores dos pesos são muito pequenos, a variância do sinal de entrada começa a diminuir assim que passa através das camadas da rede. Se os pesos são muito grandes, então a variância dos dados de entrada tende a aumentar rapidamente a cada passagem pelas camadas e, eventualmente, tornam-se inutilizáveis</p>
        <p>Para garantir que a rede possa funcionar corretamente, faz-se necessário certificar-se de que os pesos estejam em um intervalo razoável. Este processo é feito de maneira aleatória ou utilizando distribuição gaussiana.</p>
        <p>Em cada passagem pelas camadas, é desejável que se permaneça a mesma variância nos pesos. Isso ajuda a evitar problemas de sobreajustes bem como que os pesos se tornem muito grandes ou muito pequenos. Com base nesta ideia surgem os trabalhos de Glorot e Bengio (2010) e He et al. (2015), mencionados anteriormente.</p>
        <p>Dado um neurônio y com entrada x e pesos W, o cálculo da variância é dado na Eq. (27):</p>
        <p>Para a variância dos termos dentro dos parênteses, tem-se:</p>
        <p>onde E[] representa o valor esperado de uma variável. Tendo os pesos uma distribuição de média zero, elimina-se o E[], e pode-se escrever:</p>
        <p>O objetivo é manter a variação semelhante ao longo de todas as camadas. Em outras palavras, deve-se ter como objetivo tornar a variância de x seja a mesma que y. Tendo assim:</p>
        <p>onde f anin é a quantidade de neurônios de entrada da camada. Generalizando para todos os pesos W, com o objetivo de manter a mesma variância para os pesos de entrada em ambos os processos de propagação e retropropagação, tem-se as fórmulas das Eqs. (31) e (32), que são as formulas das das inicializações com distribuição normal e uniforme de Glorot e Bengio (2010), respectivamente:</p>
        <p>Outro método de inicialização de pesos foi proposto por He et al. (2015). Em seu trabalho, o autor estuda a eficácia do método de inicialização descrito anteriormente utilizando a função ReLU. As Eqs. (33) e (34), apresentam as formulas da inicializações com distribuição normal e uniforme de He et al. (2015), respectivamente:</p>
        <p>A proposta surgiu dado que a função ReLU transforma os números negativos em 0, removendo cerca de metade da variância. Sendo assim, a proposta dos autores é de dobrar a variância dos pesos para compensar isto.</p>
    <h2>3.3.5 Aprendizado Profundo (AP)</h2>
        <p>As técnicas de Aprendizado Profundo (AP) aperfeiçoaram a forma que modelos de AM convergem e generalização os dados. O primeiro relaciona-se ao aprendizado em reconhecer padrões. Este fator é importante, pois se a rede não aprendeu as relações existentes, significa que não convergiu e não atingirá bons resultados. Já o segundo tema, trata sobre reconhecimento de padrões não existentes nos dados de treinamento e assim identificar valores fora do padrão, também chamado de abstração.</p>
        <p>Os modelos de Aprendizado Profundo (AP) constituem uma área de AM, composto por métodos estatísticos que tentam modelar abstrações de alto nível de dados. O grande avanço do AP é a melhoria do aprendizado de representação e da capacidade de abstração (LECUN; BENGIO; HINTON, 2015).</p>
        <p>O aprendizado de representação é um conjunto de técnicas para descobrir matematicamente as representações de dados para detecção ou classificação por meio da extração de características. Os métodos de AM tradicionais não são precisos o suficiente para problemas mais complexos, como problemas de visão computacional.</p>
        <p>Os modelos de AP resolvem o problema do aprendizado de representação introduzindo representações que são expressas em vários níveis de abstração por várias camadas de processamento (GOODFELLOW; BENGIO; COURVILLE, 2016). Assim, o AP está evoluindo o estado da arte na solução de problemas que resistiram às melhores tentativas da comunidade de inteligência artificial por muitos anos, como reconhecimento de fala, de objetos e classificação de imagens e padrões (LECUN; BENGIO; HINTON, 2015).</p>
        <p>Existem vários modelos de AP, dentre eles pode-se citar: Rede Neural Convolucional (Convolutional Neural Network - CNN), Rede de Crença Profunda (Deep Belief Network - DBN), Máquina de Boltzmann Restrita (Restricted Boltzmann Machine - DBM) e Rede de Memória de Curto Longo Prazo (Long Short Term Memory - LSTM). Na literatura, CNN, DBN e RBM são usadas principalmente nas abordagens de classificação e reconhecimento de imagens (WU; CHEN, 2015; KARPATHY et al., 2014; CIRESAN et al., 2011), enquanto RNNs, como LSTM, são focadas em análise de dados de séries temporais, processamento de linguagem natural e reconhecimento de fala (KARIM et al., 2017; GRAVES; JAITLY; MOHAMED, 2013)</p>
    <h2>SISTEMA DE NEGOCIAÇÃO PROPOSTO</h2>
        <p>Neste capítulo, será apresentada a metodologia para a criação do sistema de tomada de decisão proposto neste trabalho, baseado na aquisição e pré processamento dos dados e sua utilização no treinamento e classificação pelo sistema proposto. </p>
        <p>Inicialmente é descrito na seção 4.1 a arquitetura do sistema proposto, seguido pelos detalhes da coleta dos dados e do pré processamento nas seções 4.2 e 4.3, respectivamente. O método de rotulagem das amostras é apresentado na seção 4.4. Por fim a arquitetura do modelo de CNN utilizado é descrita na seção 4.5.</p>
    <h2>Arquitetura do sistema</h2>
        <p>Neste trabalho, é proposta uma abordagem aplicando uma arquitetura de CNN a fim de identificar os melhores momentos de compra e venda no mercado financeiro. O sistema foi chamado CNN Trading Classifier (CNN-TC), pois o mesmo é baseado na classificação de séries temporais a fim de identificar padrões que possam indicar a operação mais rentável no momento.</p>
        <p>O processo do sistema de negociação automatizado proposto é apresentado na Figura 26. Os dados históricos são coletados e passam por um pré-processamento. Neste processo, é feito o cálculo de indicadores técnicos e a normalização dos dados. Cada amostra é então rotulada utilizando o método da seção 4.4 e os dados são utilizados para o treinamento da RNA. O modelo CNN executa a classificação de operação como compra/venda/neutro para cada dia do período de avaliação, e o resultado é utilizado para as avaliações estatística e financeira.</p>
    <h2>Dados de entrada</h2>
        <p>A base de dados inicialmente é composta por: data, volume financeiro, preços de abertura, máxima, mínima e fechamento. Como elementos de entrada da CNN, são utilizados o Preço de Fechamento Estacionário (PFE) e os indicadores técnicos previamente abordados na seção 3.1.2, dando um total de 5 elementos. Foi utilizada a Biblioteca de Análise Técnica em Python (PADIAL, acessado em 01/03/2020) para calcular os valores dos indicadores. O conjunto de elementos de entrada definido para esta abordagem foi avaliado empiricamente e escolhido o que forneceu a melhor precisão no processo de aprendizado.</p>
    <h2>Pré-processamento de dados</h2>
        <p>O conjunto de dados é dividido em amostras diárias utilizando uma abordagem de janela deslizante de tamanho 11, onde cada amostra representa um dia e é composta pelos dados dos 10 dias anteriores e o dia atual, o formato dos dados que entrarão na rede é de matrizes bidimensionais de [11x5], como mostrado na Figura 27.</p>
        <p>Na sequência, os valores de cada coluna são normalizados entre 0-1 para cada amostra, usando a normalização min-max, de acordo com a Eq. 35. Cada coluna da matriz (eixo x) representa um recurso de entrada e cada linha (eixo y) representa um dia da série temporal. Dessa forma o processo de convolução extrairá padrões sobre as representações de cada dia na matriz de entrada, cada dia será visualizado de forma independente.</p>
    <h2>Rotulação dos Dados</h2>
        <p>É utilizado o processo de treinamento supervisionado e todas as amostras diárias são rotuladas como compra, venda ou neutro, de acordo com o Algoritmo 1 usando como base os preços de fechamento. Este algoritmo consiste em uma implementação de janela deslizante baseada na proposta de Sezer e Ozbayoglu (2018), e tem por objetivo encontrar topos e fundos na oscilação dos preços para as identificar os melhores pontos para operações de compra e venda.</p>
        <p>O método de rotulagem divide a série temporal em segmentos menores. Começando no primeiro dia, avança-se usando uma janela deslizante com passo de 11. Para cada segmento, os dias subsequentes após os valores mínimo e máximo no segmento atual são marcados como compra e venda, respectivamente, e os outros dias são marcados como neutro. Esse processo se repete até o final da série. Como resultado, os pontos de virada na tendência do preço são marcados como um ponto de entrada de negociação. A Figura 28 mostra os pontos de compra e venda gerados a partir do Algoritmo 1 na base de dados do BOVA11.</p>
    <h2>Arquitetura da CNN utilizada no sistema</h2>
        <p>A arquitetura da rede CNN utilizada é apresentada na Figura 29. O modelo foi implementado utilizando a estrutura do Keras e a base das funções do TensorFlow utilizando a linguagem Python. A CNN está estruturada da seguinte forma: a entrada é uma matriz bidimensional de formato [11x5], conforme descrito anteriormente, duas camadas convolucionais (64 kernels de [1x2] e 32 kernels de [1x3]), uma camada de pooling máximo (pool-size de [1x2]), uma camada totalmente conectada (64 neurônios) e uma camada de saída de tamanho 3. Também foi utilizado um Dropout de 0,5 na rede antes das camadas totalmente conectadas.</p>
        <p>Todas as camadas utilizam a função de ativação ReLU, e a camada de saída utiliza a função Softmax. Além disso, todas as camadas são definidas para utilizar a inicialização uniforme de pesos proposta por He et al. (2015), descrita na seção 3.3.4.7.</p>
        <p>As camadas convolucionais capturam os padrões ao longo do tempo para cada recurso de entrada, as camadas de pooling máximo extraem recursos maiores e reduzem a dimensionalidade dos dados. As camadas totalmente conectadas realizam a classificação do sinal de negociação.</p>
        <p>Todos os filtros convolucionais varrem apenas ao longo do eixo x da matriz. Uma vez que um kernel finaliza a varredura em uma linha, este passa para a próxima e reinicia a varredura desde o início. Isto é crucial para a abordagem pois todo este processo, no final, combina as características extraídas de cada dia de entrada de forma resumida, sendo possível a identificação de padrões mais destacados. Como resultado, a dimensão de recursos diminui de 5 para 1 no final deste processo.</p>
        <p>A arquitetura final da CNN utilizada foi definida empiricamente, após extensos testes com vários hiper parâmetros e arranjos de camadas diferentes com o objetivo de melhorar a classificação das séries temporais com base nos trabalhos estudados, resultando no rede apresentada na Figura 29. Esta configuração foi escolhida pois foi a que apresentou os melhores resultados em termos estatísticos e de retorno financeiro durante os experimentos.</p>
    <h2>EXPERIMENTOS</h2>
        <p>Este capítulo apresentará os detalhes da metodologia de avaliação utilizada. A seção 5.1 apresenta os ativos selecionados para os experimentos. A seção 5.2 apresenta os modelos de RNA utilizados para comparação nos experimentos. Na sequência a seção 5.3 apresenta o processo de treinamento utilizado, seguida pela seção 5.5 que detalha as métricas estatísticas utilizadas na avaliação dos resultados. Por fim, as seções 5.6, 5.4 detalham a metodologia utilizada nas operações e o teste em ambiente real simulado.</p>
    <h2>Ativos utilizados nos experimentos</h2>
        <p>Os experimentos foram realizados inicialmente em ativos da Brasil, Bolsa, Balcão (B3), principalmente em ativos que compõe o Índice Bovespa (IBOVESPA), o qual consiste em uma carteira teórica composta pelas ações mais negociadas da B3, o que reflete o desempenho do mercado de ações brasileiro no geral.</p>
        <p>Sendo assim, foram utilizados os preços diários de 6 ativos do mercado financeiro brasileiro (BR) (1 ETF e 5 ações) e 6 ativos do mercado norte americano (EUA) (2 ETFs e 4 ações). Os históricos foram obtidos pelo site do Yahoo Finance 1. A Tabela 1 apresenta os ativos selecionados para os experimentos bem como os períodos de início e final de coleta dos dados utilizados.</p>
        <p>Os ativos do mercado brasileiro foram escolhidos pelo seguinte critério: o BOVA11 pois este replica o portfólio do IBOVESPA; as ações por serem algumas das com maiores ponderações na carteira teórica do IBOVESPA do terceiro quadrimestre de 2020, as chamadas blue chips, e sendo uma de cada setor e com histórico suficiente para a avaliação.</p>
        <p>Cada ação representava a seguinte ponderação no portfólio do IBOVESPA 2: VALE3 com 10,64% do setor de mineração; ITUB4 com 6,17%, sendo o maior banco privado do Brasil;</p>
        <p>PETR4 sendo 5,24%, a maior petrolífera brasileira; ABEV3 com 3,11%, do setor de bebidas e alimentos; e WEGE3 com 2,45%, sendo uma das maiores produtoras de máquinas elétricas, automação e tintas industriais.</p>
        <p>No mercado norte americano, foram selecionadas uma das maiores empresas da bolsa americana de tecnologia (NASDAQ), a Apple Inc. (AAPL), e o banco Wells Fargo & Co. (WFC) por ser um dos maiores bancos americanos. As demais ações e ETFs foram utilizadas para comparação com o sistema CNN-TA, o qual realizou experimentos nas mesmas. Tais ativos foram JPM, uma empresa de serviços financeiros em gerais sediada nos EUA. TRV, uma empresa do setor de seguros, também sediada nos EUA. E por último, as ETFs XLE e XLF que de forma semelhante ao BOVA11, consistem em uma carteira teórica de ativos, no caso, dos setores de energia e financeiro, respectivamente.</p>
    <h2>Desenvolvimento dos Modelos Comparados</h2>
        <p>O CNN-TC foi comparado com um modelo de CNN semelhante e base deste trabalho, o CNN-TA. Também foram desenvolvidos outros dois modelos de RNAs, uma rede MLP, a fim de comparar a classificação de operação utilizando um modelo de RNA mais simples, e uma LSTM, muito utilizada em análises de séries temporais, como mencionado no capítulo 2. Esta comparação tem por objetivo testar a eficácia desta abordagem de classificação de operação frente à utilização de modelos mais simples ou semelhantes em termos de métricas estatísticas e retorno financeiro das estratégias.</p>
        <p>A implementação do CNN-TA foi a melhor possível de se obter dadas as informações fornecidas no artigo. Também foram feitos ajustes finos para os principais hiper parâmetros a fim de obter o melhor resultado possível deste sistema.</p>
        <p>Outras duas RNAs receberam os mesmos dados de entrada do CNN-TC e foram treinados com o mesmo método de rotulagem deste trabalho. O modelo MLP foi implementado com 3 camadas, tendo 110, 64 e 3 neurônios, respectivamente. O modelo LSTM foi implementado com 1 camada recorrente de 32 unidades e 2 camadas totalmente conectadas de 64 e 3 neurônios, respectivamente. Semelhantemente ao CNN-TC, todas as camadas utilizaram a função de ativação ReLu e a última utilizou Softmax.</p>
    <h2>Processo de Treinamento</h2>
        <p>Cada sessão de treinamento foi realizada com tamanho de lote de entrada de 128 amostras. Foi escolhido este tamanho de lote para que o treinamento da rede fosse mais lento a fim melhorar o aprendizado e que permitisse uma generalização mais eficiente; por se tratar de análise de série temporal, nem sempre há características especificamente diferentes o suficiente nas amostras para que a rede seja capaz de abstrair rapidamente.</p>
        <p>Foi utilizado o algoritmo de otimização Adam, com taxa de aprendizado de 1xe−4. Este é um método de otimização que calcula taxas de aprendizado adaptáveis para cada parâmetro. Foi escolhido o algoritmo Adam pois conforme demonstrado na seção 3.3.4.6, este demonstra ser um algoritmo computacionalmente mais eficiente que seus antecessores, tais como Adadelta e Adagrad. Como métricas de treinamento foram utilizados acurácia e F1 ponderado.</p>
        <p>Para otimizar o treinamento e evitar o problema de sobreajuste, o recurso do Keras de parada antecipada foi utilizado, monitorando o decrescimento de erros no conjunto de validação. A quantidade de pontos de compra/venda são menos frequentes que os da classe neutro, ou seja, as classes são desbalanceadas. Sendo assim para melhorar o treinamento, foi utilizado o recurso de amostras ponderadas. O peso de cada amostra é calculado e utilizado para configurar o Keras para prestar menos atenção à classe neutro, a fim de identificar melhor as características mais das classes compra e venda.</p>
        <p>As sessões de treinamento foram realizadas em janelas deslizantes com abordagem de reciclagem de conhecimento, conforme representado na Figura 30. Foi escolhida essa configuração para evitar o problema de diferentes comportamentos de mercado em diferentes períodos. A configuração de treinamento mais comum é baseada em janela estática, mas, historicamente, o comportamento do mercado de ações é composto por períodos de ascensão e queda ao longo do tempo. Se treinarmos a rede apenas em um período de alta e testarmos em um período de queda, a classificação poderá ser afetada negativamente.</p>
        <p>Esta metodologia de treinamento é baseada na que foi utilizada por Sezer e Ozbayoglu. Durante o treinamento, foram retirados seis anos do conjunto de dados e divididos 20% para validação cruzada. O ano subsequente da amostras de dados foi utilizado para as avaliações estatística e financeira. Em seguida, foi avançado 1 ano, e o modelo foi retreinado e reavaliado novamente com os novos dados.</p>
    <h2>Testes em Ambiente Simulado Utilizando o MetaTrader</h2>
        <p>Após os treinamentos dos modelos e os testes com dados históricos, foi realizado um teste em ambiente real de forma simulada a fim de se avaliar os resultados desta pesquisa aplicando o conhecimento adquirido pelo modelo em classificar as operações de negociação para cada dia na B3.</p>
        <p>Para isto, foi utilizado o software MetaTrader 5, uma plataforma de negociação comumente utilizada para negociação por meio de robôs automatizados. A integração do modelo com o MetaTrader foi feita utilizando sua Interface de Programação de Aplicações (Application Programming Interface) (API) com o Python. As operações foram realizadas em lotes de 10 quantidades, como descrito na seção 5.6.</p>
        <p>O objetivo é validar a abordagem desenvolvida neste trabalho em um ambiente real, verificando sua eficácia e rentabilidade com dados vindos da plataforma. Foi feita coleta diária dos dados de mercado utilizando a API do MetaTrader 5 no horário de leilão de fechamento do mercado à vista da B3, executada a classificação e tomada a decisão, de forma semelhante ao método adotado na avaliação financeira com os dados históricos.</p>
    <h2>Avaliação Estatística</h2>
        <p>Devido às classes serem desbalanceadas, as métricas estatísticas para cada classe foram calculadas e o valor final de cada métrica consiste em uma média ponderada das 3 classes. Cada conjunto de dados foi avaliado separadamente, calculando as métricas acurácia, precisão, revocação e F1 ponderados. Para isto foi utilizada a biblioteca Scikit Learn do Python. A seguir é apresentado o método de cálculo base para cada métrica para melhor compreensão, onde:</p>
        <ul>
            <li>VP: verdadeiro positivo, por exemplo é classificado compra em um dia que foi rotulado como compra na base de dados;</li>
            <li>VN: verdadeiro negativo, por exemplo não é classificado venda/neutro em um dia que foi rotulado como compra;</li>
            <li>FP: falso positivo, por exemplo é classificado compra em um dia que foi rotulado como venda na base de dados;</li>
            <li>FN: falso negativo, por exemplo a classificação deveria ser compra mas foi classificado venda;</li>
        </ul>
    <h2>Acurácia</h2>
        <p>Esta métrica indica um desempenho geral do modelo, levando em conta o número de predições corretas, dividida pelo total de predições realizadas. Resumidamente é mensurado: dentre todas as classificações, quantas o modelo classificou corretamente. O cálculo da mesma se dá pela Eq. (36).</p>
    <h2>Precisão</h2>
        <p>A precisão mensura o quão preciso é o modelo em relação aos positivos previstos, quantos deles são realmente verdadeiros positivos. Em outras palavras, quantas classificações estão corretas. A fórmula é apresentada na Eq. (37).</p>
    <h2>Revocação</h2>
        <p>A métrica Revocação calcula quantos dos positivos reais o modelo foi capaz de identificar, rotulando-o como positivo (verdadeiro positivo). Este calculo é feito utilizando a fórmula na Eq. (38).</p>
    <h2>F1</h2>
        <p>O F1 consiste em uma média harmônica entre Precisão e Revocação a fim de mensurar a eficácia utilizando um único número. O cálculo é feito pela Eq. (39).</p>
    <h2>Algoritmo de Avaliação Financeira</h2>
        <p>Foram simuladas operações de negociação nos conjuntos de dados de teste a cada sessão de treinamento de acordo com o Algoritmo 2. Esta avaliação se dá realizando as simulações de compra e venda no momento da classificação, utilizando o preço de fechamento do ativo.</p>
        <p>O desempenho do CNN-TC foi comparado à estratégia BH e com os resultados obtidos utilizando os demais modelos. Vale ressaltar que a avaliação foi feita com a estratégia longonly, o que significa que busca ganho financeiro comprando o ativo e esperando que o seu preço aumente para vender.</p>
        <p>No mercado de financeiro brasileiro, o lote padrão para compra de ações é de múltiplos de 100 e para ETFs é múltiplos de 10, enquanto no mercado norte americano não existe lote mínimo, podendo até comprar frações de ação em algumas corretoras; nos experimentos foi adotada a mesma quantidade utilizada no mercado brasileiro. Além disso, para as ações do mercado financeiro americano não foi considerada a variação cambial.</p>
        <p>As operações foram executadas de acordo com a quantidade de lote descrita acima: no primeiro sinal de negociação, a classificação de ação obtida para o dia atual é tomada. Se o for neutro, nenhuma ação será tomada. Se for classificado como compra, será comprado no fechamento daquele dia com todo o valor disponível em conta (isso quando ainda não tiver sido comprado), o restante irá para o caixa. Se for venda, todos os ativos serão vendidos (quando ainda não estiverem vendidos). O valor inicial da avaliação foi de R1 10.000.</p>
        <p>Além disso, a título de comparação dos resultados financeiros frente a investimentos de renda fixa, que são considerados mais simples pela maioria dos investidores, foi calculado o retorno do Certificado de Depósito Interbancário (CDI) acumulado nos períodos de simulação.</p>
        <p>O CDI consiste em um título emitido pelos bancos para a realização de operações de empréstimo entre si, em uma modalidade de curtíssimo prazo. Da mesma forma, os investidores podem emprestar o seu dinheiro para as instituições financeiras, e a mesma devolve o valor corrigido pela taxa acordada no ato do empréstimo na data de vencimento do título. Geralmente estes títulos são indexados com base em uma porcentagem do CDI. Para esta comparação foi considerada uma taxa de 100% do CDI.</p>
        <p>Os cálculos foram realizados utilizando uma calculadora disponibilizada pelo Banco Central do Brasil (BCB). A Figura 31 apresenta o cálculo do CDI no primeiro período de avaliação financeiro, de 02/01/2015 a 01/01/2019. Na Figura 32 é apresentado o resultado o retorno do CDI entre 01/03/2006 e 01/01/2012. Por último, a Figura 33 apresenta o valor de 01/03/2007 à 01/01/2016.</p>
    <h2>RESULTADOS</h2>
        <p>Neste capítulo serão apresentadas e comentadas as métricas obtidas em cada ativo para cada estratégia, e na sequência serão plotados os desempenhos financeiros de cada estratégia.</p>
        <p>Cada ativo foi avaliado separadamente, utilizando acurácia, precisão, revocação e F1 ponderados, métricas comentadas na seção 5.5, a fim de mensurar a consistência das métricas estatísticas em diversas condições nos dados históricos. Os resultados apresentados são referentes a todo o período utilizado para a avaliação financeira.</p>
    <h2>BOVA11</h2>
        <p>A Tabela 2 apresenta as métricas estatísticas para o ativo BOVA11. Como pode ser visto, a acurácia do sistema CNN-TC apresentou-se consideravelmente melhor que os demais modelos, com uma vantagem de 13,35% para o segundo melhor nesta métrica. Em termos de precisão, pode-se notar que os sistemas CNN-TC e CNN-TA alcançaram taxas próximas de 80%, o que indica que estas abordagens foram capazes de identificar características específicas das classes na maioria dos casos. Baseando-se no F1 pode-se notar uma clara vantagem do CNN-TC em relação aos demais modelos para os experimentos realizados.</p>
        <p>Na Figura 34 é apresentado o retorno financeiro para cada estratégia. Avaliando os desempenhos obtidos, pode-se observar que o CNN-TC alcançou resultados bem superiores às demais estratégias, inclusive superando o BH. Considerando o retorno do CDI, que foi de 49,62%, pode-se observar também que todos os modelos obtiveram retornos acima deste benchmark.</p>
    <h2>VALE3</h2>
        <p>Na Tabela 3 tem-se as métricas para o ativo VALE3. A precisão das abordagens baseadas em CNN foram próximas de 80%, porém a acurácia evidencia que o estratégia CNN-TC foi o que obteve maior número de classificações corretas. Já o CNN-TA, apesar de precisão elevada, a menor acurácia e o seu método de rotulagem não corroboraram, fazendo com que fossem realizadas vendas de forma antecipada e prejudicando o seu resultado financeiro.</p>
        <p>Na Figura 35 é possível visualizar que embora os modelos MLP e LSTM tenham sido inferiores nas métricas supradescritas, estes também obtiveram resultados financeiros satisfatórios, superando a estratégia utilizando o CNN-TA, bem como o BH. Além disso todas as RNAs superaram o CDI acumulado do período de avaliação. Portante pode-se concluir que o método de rotulagem proposto neste trabalho corroborou para melhores resultados financeiros dos modelos comparados ao CNN-TA.</p>
    <h2>PETR4</h2>
        <p>Na Tabela 4 são apresentadas as métricas para o ativo PETR4. Para este ativo é evidente a vantagem do sistema CNN-TA, superando os demais em todas as métricas. O F1 do CNN-TA, que consiste em um número com o objetivo de ser uma média harmônica entre precisão e revocação, foi consideravelmente superior aos demais modelos, com uma vantagem de 6,59% sobre o CNN-TC. Vale destacar que o ativo apresentou movimentos abruptos no período de avaliação, podendo ter comprometido o desempenho dos modelos.</p>
        <p>Embora as métricas apresentadas na tabela acima tenham sido consideravelmente satisfatórias, na Figura 36 é possível visualizar que o retorno financeiro das estratégias MLP e LSTM não alcançaram resultados tão bons, apresentando prejuízos. O comportamento de ambos dos modelos aparenta ter sido influenciado negativamente por notícias relacionadas à empresa no período analisado. Nota-se que nos momentos de alta, ambos os modelos não acompanham, realizando venda de forma antecipada.</p>
        <p>Os sistemas CNN-TC e CNN-TA apresentaram comportamento próximos na maior parte do tempo, entretanto o CNN-TA foi capaz de antecipar a maior queda que ocorreu durante o período de avaliação e obteve assim um retorno financeiro maior. Pode-se então concluir que o método de rotulagem usado pelo CNN-TA foi o mais adequado para este ativo.</p>
    <h2>ITUB4</h2>
        <p>As métricas de ITUB4 são apresentadas na Tabela 5. Como se pode observar, neste ativo o sistema CNN-TC, proposto neste trabalho, alcançou resultados melhores em quase todas as métricas. Apesar de ter perdido em precisão para o CNN-TA, a acurácia do CNN-TC, que consiste em uma métrica a fim de mensurar o desempenho global do modelo, foi superior, evidenciando que este sistema acertou mais as classificações, no geral, o que ajudou o F1 a obter resultado estatístico superior.</p>
        <p>Na Figura 34 é apresentado o gráfico do retorno financeiro das estratégias avaliadas. A tendência de alta no preço ao longo do período é evidente e muito semelhante ao comportamento do BOVA11. Pode-se observar que o CNN-TC alcançou resultados superiores, sendo capaz de antecipar os momentos de queda, garantindo maior rentabilidade. Todas as abordagens superaram a rentabilidade do CDI, que foi de aproximadamente 49%. Entretanto, as estratégias CNN-TA e LSTM não superaram a estratégia BH. Conforme demonstrado na tabela de métricas, pode-se concluir que o método de rotulagem proposto neste trabalho, em conjunto com melhores métricas corroborou com os resultados do sistema CNN-TC e demais modelos que utilizaram este método, evidenciando sua capacidade de aproveitar tendência de alta nos preços.</p>
    <h2>ABEV3</h2>
        <p>A Tabela 6 apresenta as métricas para o ativo ABEV3. Para este ativo os sistema utilizando CNN novamente obtiveram melhores resultados de classificação frente aos demais. Apesar de precisão levemente superior do CNN-TA, no geral o CNN-TC foi melhor, o que fica evidenciado pela vantagem em termos de F1. Acredita-se que por se tratar de um ativo que o seu preço oscilou em uma faixa de preço sem grandes tendências de alta ou baixa possa ter influenciado nos resultados estatísticos dos demais modelos, e ressalta a capacidade das CNNs em identificar padrões de negociação.</p>
        <p>Na Figura 38 pode-se visualizar o desempenho das estratégias de negociação para ABEV3. Apesar do ativo não ter apresentado tendência clara ao longo do período de avaliação, os sistemas baseados em CNN foram capazes de alcançar resultados financeiros acima dos demais. Todos as estratégias, no final, superaram a estratégia BH, que apresentou um leve prejuízo no período avaliado. Somente o sistema CNN-TC foi capaz de superar o CDI.</p>
    <h2>WEGE3</h2>
        <p>Na Tabela 7 pode-se observar as métricas para o ativo WEGE3. As acurácias dos sistemas de CNN-TC e LSTM foram superiores. Pode-se notar também que em termos de precisão que todos os modelos que utilizaram o método de rotulagem proposto neste trabalho apresentaram taxas superiores a 75%, o que indica que na maioria dos casos, a classificação de verdadeiros positivos foi bem sucedida. Pode-se concluir, em termos gerais, que a abordagem que foi menos eficaz nas classificações foi o CNN-TA.</p>
        <p>Como se pode observar na Figura 39, os resultados do sistemas CNN-TC foram superiores. Os sistemas CNN-TC e LSTM apresentaram métricas próximas, o que também é refletido no resultado financeiro onde ambos tiveram desempenho próximos na maior parte do tempo. O CNN-TA também acompanhou a rentabilidade do CNN-TC, porém chegando ao final do período de avaliação, o mesmo não foi capaz de identificar padrões de negociações rentáveis. É possível notar que os períodos de alta no preço não são acompanhados pela maioria das estratégia, principalmente o MLP, onde é previsto venda de forma antecipada, interferido no retorno financeiro das estratégias.</p>
    <h2>AAPL</h2>
        <p>A Tabela 8 apresenta as métricas para o ativo AAPL. Como se pode observar, as taxas de acurácia dos modelos não foram tão boas quanto os demais ativos até aqui comentados, ficando na maioria próximas de 50%. Porém vale destacar que em termos de precisão, o CNN-TC novamente se destacou nesta métrica, o que evidencia sua melhor capacidade de identificação de pontos operação corretos, o que consequentemente corroborou para melhor taxa de F1.</p>
        <p>Como é possível observar na Figura 40, as abordagens usando CNN foram os que mais se aproximaram do retorno obtido pela estratégia BH. Entretanto os resultados não superaram esta estratégia nem o retorno do CDI ao longo do período. Assim como comentado na ação WEGE3, neste caso, os períodos de alta do preço não foram totalmente acompanhados pelos modelos, onde foi prevista venda antecipada impactando nos resultados.</p>
        <p>Vale também ressaltar que tais movimentos no ativo aconteceram de forma exponencial, o que impacta diretamente nos cálculos dos indicadores levando-os rapidamente para região de sobrecompra, desta forma, o algoritmo é induzido a entender como um possível topo do preço.</p>
    <h2>WFC</h2>
        <p>A seguir são apresentadas as métricas para o ativo WFC. O comportamento do preço desta ação oscilou em uma faixa de valores sem uma tendência evidente. Entretanto, neste ativo a estratégia que se destacou nas métricas foi a LSTM. Apesar das CNNs terem apresentado resultados próximos, nota-se que o CNN-TC alcançou taxa de F1 superior.</p>
        <p>Apesar desta ação não ter apresentado uma tendência altista ou baixista, como se pode observar na Figura 41, todas as abordagens, exceto o MLP, obtiveram bons resultados financeiros. Assim como comentado sobre as métricas estatísticas, é possível notar um comportamento semelhante os sistemas CNN-TC, CNN-TA e LSTM. Já o MLP não foi capaz de acompanhar os períodos de alta no preço, impactando negativamente seu resultado, o que evidencia a superioridade dos demais modelos, principalmente CNN, na classificação dos pontos de operação neste ativo.</p>
        <p>Pode-se também destacar que os 2 métodos de rotulagem utilizados demonstraram-se eficazes para o treinamento dos sistemas, o que fica evidenciado pelo comportamento CNN-TC, CNN-TA e LSTM. Nota-se que o CNN-TA chegou próximo do resultado financeiro dos demais, o que demonstra que o seu método e rotulagem e bem aplicável para o comportamento deste ativo. Por último, vale comentar que apesar do CNN-TA ter superado o CDI em 2 momentos, todas as estratégias obtiveram retornos abaixo do CDI no final.</p>
    <h2>JPM</h2>
        <p>A Tabela 10 apresenta as métricas para o ativo JPM. E termos de acurácia e precisão, os sistemas CNN-TC e LSTM foram superiores frente aos demais. Quando analisa-se as taxas de F1, o MLP foi o mais inferior; enquanto o LSTM obteve resultado estatístico, no geral, superior, seguido pelo CNN-TC.</p>
        <p>Durante o período de avaliação ocorreu uma forte tendência baixista entre 2008/2009 conforme ser visto no gráfico da Figura 42 onde o BH apresentou um retorno de quase -50. No entanto, os sistemas oscilaram entre perdas e ganhos próximos do valor inicial. No restante do período, a ação não apresentou uma tendência primaria clara. Apesar dos pontos comentados acima sobre as métricas e a crise financeira ocorrida durante o período de avaliação, todas as estratégias obtiveram bons resultados financeiros, tendo destaque para a LSTM e CNN-TA. Além disso, todos os sistemas superaram o CDI do período de avaliação.</p>
        <p>Apesar das taxas de acurácia não tenham sido totalmente satisfatórias, sendo próximas de 55%, os resultados financeiros não foram impactados negativamente. O CNN-TA alcançou um resultado financeiro próximo dos demais, mesmo tendo apresentado métricas próximas ao MLP. Embora possa-se visualizar um comportamento semelhante dos ativos durante certo período, evidenciando eficácia de ambos os métodos de rotulagem para treinar os modelos, pode-se concluir que o método de rotulagem do CNN-TA mostrou-se mais adequado para este ativo, pois mesmo com métricas inferiores este foi capaz de alcançar resultados próximos. Caso o sistema mostra-se mais preciso, poderia ter alcançado resultado melhor.</p>
        <p>Acredita-se que a crise financeira ocorrida durante o período avaliado tenha impactado negativamente a capacidade dos modelos de identificarem tendências e padrões que pudessem fornecer pontos de operação mais rentáveis em alguns momentos. Após o período da crise é possível observar que os modelos foram capazes de acompanhar o movimento do preço com maior precisão.</p>
    <h2>TRV</h2>
        <p>A Tabela 11 apresenta as métricas para o ativo TRV. Neste ativo todos os sistemas apresentaram taxas de precisão elevadas, próximas de 77%, onde o CNN-TA obteve o melhor resultado. Entretanto a melhor acurácia contribuiu para um melhor resultado do CNN-TC em termos de F1 dentre todos, com uma vantagem de 1,28% frente ao CNN-TA, evidenciando que o CNN-TC foi capaz de realizar mais classificações corretas, no geral.</p>
        <p>Na Figura 43 é possível observar que todos as estratégias apresentaram resultados acima do BH e do CDI acumulado do período. Neste ativo o sistema CNN-TA apresentou o melhor retorno financeiro, seguido pelo CNN-TC. Devido às métricas de ambos não haverem apresentado valores muito distantes, pode-se concluir que o método de rotulagem utilizado para o CNN-TA auxiliou no retorno financeiro acima dos demais.</p>
    <h2>XLE</h2>
        <p>Na Tabela 12 a seguir são apresentadas as métricas para a ETF XLE. Como se pode observar, os sistemas CNN-TC e LSTM apresentaram as melhores métricas, com taxas de acurácia e precisão próximas de 55% e 80%, respectivamente. Na sequência o CNN-TA apresentou precisão próxima do LSTM, com 76,52% e resultado de 59,71% para F1.</p>
        <p>Nesta ETF o melhor resultado financeiro apresentado foi o do sistema CNN-TC, conforme ilustrado na Figura 44. É possível observar também que os sistemas CNN-TA e LSTM apresentaram retornos próximos, porém abaixo do retorno do CDI. Apesar de ter apresentado um retorno expressivo frente à estratégia BH, o MLP não se distanciou desta estratégia no final do período de avaliação.</p>
        <P>Ademais, embora as métricas para o sistema CNN-TA tenham sido consideravelmente boas, isso não se refletiu em retorno financeiro. Desta forma, pode-se concluir que o método de rotulagem proposto para o CNN-TC bem como as métricas superiores foram responsáveis pelo elevado retorno financeiro frente às demais abordagens.</P>
    <h2>XLF</h2>
        <p>Por fim, as métricas para a ETF XLF são demonstradas na Tabela 13. No período avaliado o preço deste ativo apresentou uma tendência de queda seguido de uma tendência de alta íngrime após o ano de 2012. Em termos de acurácia a maioria dos sistemas apresentaram resultados semelhantes (em torno de 55%). Em acurácia e precisão, o CNN-TC destacou-se frente aos demais, seguido pelo LSTM. Pode-se visualizar pela métrica F1 que o CNN-TC foi o sistema superior, o que é refletido também no retorno financeiro, principalmente quando comparado com o MLP e LSTM, treinados com o mesmo método de rotulagem, que apesar de métricas relativamente próximas, pode-se notar uma diferença no retorno deste entre 2009 e 2012.</p>
        <p>Na Figura 45 é apresentado o retorno o retorno financeiro deste ativo. Apesar de superarem a estratégia BH, nenhuma das estratégias superou o retorno do CDI. Isso pode ser explicado devido à tendência de baixa entre 2007 e 2009, que impactou no retorno dos sistemas durante parte do período de avaliação. Apesar disto, os sistemas oscilaram entre perdas e ganhos acima do retorno do BH.</p>
        <p>O diferencial se deu no início da tendência de alta que se iniciou logo após o ano de 2009, onde o CNN-TC descolou-se de forma mais evidente dos demais. O MLP comportou-se de forma semelhante em parte deste período de recuperação. No restante do período as estratégias demonstraram retornos financeiros muito próximos, exceto pelo CNN-TC que foi capaz de identificar com melhor precisão os topos e fundos do preço. Por último, pode-se concluir que o método de rotulagem alinhado com as métricas estatísticas apresentadas pelo CNN-TC proporcionaram-lhe o melhor desempenho financeiro para este ativo.</p>
    <h2>Custos e Emolumentos</h2>
        <p>A B3 (Bolsa Brasil Balcão) é a empresa responsável por gerenciar as operações do mercado financeiro brasileiro. Esta surgiu em 2017 como resultado da fusão entre a antiga BM&F Bovespa (Bolsa de Valores, Mercadorias e Futuros de São Paulo) e a Cetip (Central de Custódia e de Liquidação Financeira de Títulos).</p>
        <p>Neste trabalho não foram consideradas taxas de corretagem, pois atualmente existem corretoras que oferecem planos sem corretagem, o que não impacta o resultado financeiro em nenhuma das estratégias.</p>
        <p>Para as operações na bolsa brasileira, é cobrada uma taxa para todas as ordens executadas, chamada Emolumentos. Esta é subtraída de uma porcentagem do volume financeiro total negociado. A tabela 14 apresenta as taxas de operação para pessoas físicas e fundos de investimento.</p>
        <p>Para a estratégia BH, os Emolumentos são irrisórios. Mas para sistemas que realizam operações com maior frequência seria injusta uma comparação sem considerar tais taxas. Para isto foi calculado o desconto médio por execução para verificar se é cabível não desconsiderar tais taxas da B3</p>
        <p>Os sistemas executam de 60 a 100 operações anualmente, sendo uma média de 80 operações e aproximadamente 50% para cada possível operação (compra e venda). Sendo assim, foram consideradas em média 40 negociações de compra e 40 de venda. Considerou-se para este trabalho as taxas para investidores de pessoa física, sendo esta 0.030747%.</p>
        <p>O lucro médio entre os ativos brasileiros neste trabalho utilizando o sistema CNN-TC foi de 157.34%. Isto representa um lucro médio de R115.734,00. Com base neste valor pode-se calcular o desconto médio por operação calculando R115.734,00 ∗ 0,00030747 = R14,83. E o valor médio total dos Emolumentos, sendo 4 anos nos períodos de análise, 80 ∗ R14,83 ∗ 4 = R11.545,60. Este valor representa apenas 9,82% de desconto do lucro total, não impactando de forma significativa o retorno financeiro. Sendo assim não é necessário a consideração desta taxa para fins de comparação.</p>
    <h2>Teste em ambiente simulado</h2>
        <p>Para esta avaliação foi escolhido o ativo BOVA11 com o mesmo modelo utilizado na avaliação dos resultados neste mesmo capítulo.</p>
        <p>A Figura 46 apresenta o retorno obtido com o sistema CNN-TC em comparação com a estratégia BH. Como se pode observar, apesar do retorno financeiro semelhante em alguns momentos e de um período não tão longo quanto os testes realizados anteriormente, que o modelo foi capaz de identificar topos e fundos durante o período analisado, alcançando assim um resultado financeiro superior.</p>
        <p>Nota-se que nos momentos de queda, o modelo foi capaz de vender antecipadamente, preservando capital para comprar a um preço inferior. A Figura 47 apresenta o relatório financeiro gerado pelo software MetaTrader 5. Como se pode observar, o valor inicial investido foi de R1 10.000.000,00 e ao final do período avaliado, o resultado do CNN-TC foi um lucro de R1 2.155.593,10, enquanto a estratégia BH obteve um lucro de R1 1.876.092,40.</p>
    <h2>Discussões</h2>
        <p>A Tabela 15 sumariza os resultados financeiros das estratégias analisadas. Como se pode ver, o sistema CNN-TC obteve melhor resultado em 6 dos 12 ativos analisados frente à todas as estratégias, e quando analisado somente as estratégias utilizando RNAs, este foi melhor em 9 dos 12 ativos. Os resultados financeiros foram satisfatórios comparados às demais estratégias adotadas para comparação, apresentando grande diferença no valor final em alguns casos.</p>
        <p>Para melhor visualização das métricas dos sistemas apresentados neste trabalho, os ativos de cada mercado alvo deste estudo foram agrupados e calculado média e desvios padrão das principais métricas. Nas Tabelas 16 e 17 são apresentadas as respectivas médias e desvios padrão para o mercado brasileiro, e na sequência, nas Tabelas 18 e 19, para o mercado americano.</p>
        <p>Para o mercado brasileiro, nota-se que o sistema CNN-TC apresentou resultados mais consistentes que os demais. Apesar de desvios padrão próximos do sistema LSTM em algumas métricas, as médias das métricas ficaram acima de quase todas as estratégias comparadas. Na sequência tem-se o sistema CNN-TA, que apesar de um desvio padrão mais elevado que os demais, apresentou precisão levemente superior ao CNN-TC, com diferença de 0,58%, e F1 consideravelmente aceitável e acima do MLP e LSTM. Apesar disto, o único ativo no qual o CNN-TA mostrou resultado financeiro superior foi para PETR4, ativo o qual pode ter sido o grande influenciador para desvios padrão elevados entre os sistemas. Os sistemas utilizando MLP e LSTM apresentaram médias próximas e abaixo do CNN-TA.</p>
        <p>No mercado de ações americano, embora em termos de acurácia os sistemas CNN-TC e LSTM se comportaram de forma semelhante, note-se um desvio padrão superior em termos de precisão para o LSTM, evidenciando resultados mais consistentes por parte do CNN-TC. É possível observar também que os sistemas CNN-TC, CNN-TA e LSTM apresentaram os melhores valores de F1, com uma diferença de 1,65% entre o CNN-TC e o CNN-TA, enquanto a diferença entre o CNN-TC e o sistema LSTM foi de 2,05%, o que ressalta melhor aplicabilidade do CNN-TC para este mercado. Vale ressaltar que os sistemas CNN-TC e LSTM apresentaram as melhores médias de acurácia, evidenciando melhor capacidade de classificação neste mercado frente ao CNN-TA, no geral. Entretanto, dos 6 ativos utilizados neste trabalho, o CNN-TA apresentou melhor retorno financeiro em apenas 1 ativo e praticamente empatou em retorno financeiro com os demais sistemas em 4 ativos. O sistema LSTM apresentou resultado financeiro claramente melhor apenas no ativo JPM. Já o CNN-TC alcançou melhores resultados financeiros nos ativos XLE e XLF e empatou com o CNN-TA em 2 ativos.</p>
        <p>Uma ferramenta de avaliação de tarefas de classificação é a matriz de confusão, que mostra quantas amostras foram classificadas em cada uma das classes e quais foram corretamente ou erroneamente classificadas. Como exemplo, a Tabela 20 apresenta as matrizes de confusão dos sistemas analisados no ativo BOVA11.</p>
        <p>Como se pode observar, devido às classes Compra e Venda serem menos comuns, existe uma dificuldade inerente do algoritmo de capturar características especificas, podendo levar a uma sobre-classificação da classe Neutro. Desta forma, muitos pontos falsos de entrada e saída de operação são gerados. A confusão com a classe Neutro não necessariamente prejudica o retorno financeiro, pois em caso de classificações repetidas, nenhuma ação é tomada. Entretanto confundir a classe Venda com Compra (falso positivo) ou Compra com Venda (falso negativo) pode comprometer o retorno financeiro.</p>
        <p>Nota-se que o sistema CNN-TC foi capaz de identificar com maior precisão as classes quando comparado com os demais algoritmos treinados com o mesmo método de rotulagem (MLP e LSTM). A quantidade de vendas classificadas pelo CNN-TC foi menor, permitindo que este sistema acompanhasse os períodos de alta no preço, além disso a quantidade de classificações erradas da classe Neutro foi menor. O sistema MLP apresentou maior confusão nas classes Compra e Venda quando comparado com os demais que utilizaram o mesmo método de rotulagem, onde o desempenho financeiro ficou próximo da estratégia BH. Semelhantemente o LSTM apresentou retorno financeiro próximo. Este foi capaz de identificar Vendas e Compras com maior precisão, entretanto a confusão com a classe Neutro foi mais frequente, o que pode ter executado vendas de forma antecipada, prejudicando o seu retorno financeiro.</p>
        <p>O sistema CNN-TA apresentou maior confusão com a classe Neutro. As amostras rotuladas como Compra foram identificadas em menor quantidade que as de Venda. Estes podem ter sido o motivo de retorno financeiro inferior frente aos demais algoritmos comparados, onde é identificada venda de forma antecipada. Além disso, a quantidade de amostras de compra e venda geradas pelo método de rotulagem deste sistema é menor, e isto pode ter prejudicado o desempenho do modelo em abstrair características destas classes.</p>
        <p>Apesar de algumas métricas, no geral, não terem ficado tão distantes, nota-se uma diferença no retorno financeiro entre os algoritmos. Por fim, com base nas avaliações realizadas, pode-se concluir que os sistemas baseados em CNN apresentaram métricas, no geral, melhores que os demais para classificação, isto evidencia a capacidade dos mesmos na identificação de padrões em séries temporais para classificação. Os sistemas que utilizaram LSTM demonstraram resultados estatísticos melhores em 2 ativos, demonstrando que este modelo de RNA também pode ser eficiente para tarefa de classificação em alguns casos. </p>
        <p>Embora o sistema CNN-TA não tenha superado o retorno financeiro do CNN-TC na maioria das avaliações, pode-se associar este fato ao método de rotulagem utilizado em sua proposta, pois como mencionado nos resultados, no mercado americano este sistema apresentou métricas próximas do CNN-TC e retorno financeiro superior em alguns casos.</p>
        <p>Ao analisar os gráficos dos resultados financeiros pode-se observar que o modelo é capaz de antecipar os maiores movimentos de queda, preservando capital para comprar na baixa uma maior quantidade de ações e assim aumentar o retorno ao longo do tempo. Embora o período de teste em ambiente simulado tenha sido curto, pode-se observar comportamento semelhante no mesmo.</p>
        <p>Sendo assim, com base nas avaliações realizadas e tendo como base o retorno esperado dos métodos de rotulagem, pode-se concluir que boas métricas de classificação em conjunto com o método de rotulagem proposto neste trabalho proporcionaram resultados melhores para o sistema CNN-TC na maioria dos ativos analisados.</p>
    <h2>CONCLUSÃO</h2>
        <p>Neste trabalho, foi proposto um sistema que utiliza um modelo de CNN com o objetivo de prever os melhores momentos de compra e venda para o mercado financeiro. O sistema foi avaliado nos mercados de ações brasileiro e americano, e para isso foram utilizadas algumas das principais ações que compõe o IBOVESPA bem como alguns ativos selecionados do mercado americano, sendo 4 deles os mesmos utilizados na proposta do sistema CNN-TA para fins de comparação.</p>
        <p>Como comparação, foram implementados 3 modelos de RNAs, uma MLP, uma LSTM e outro sistema baseado em CNN, chamado de CNN-TA (SEZER; OZBAYOGLU, 2018). Foram realizadas avaliações estatística e financeira a fim de mensurar a eficácia destes sistemas na identificação dos momentos de operação e avaliar se os mesmos superariam a estratégia BH, sendo esta a estratégia mais simples para o investimento em bolsa de valores.</p>
        <p>Embora nos períodos analisados tenham ocorrido fatos atenuantes, tais como crise financeira e notícias relacionadas às empresas em específico, os essistemas apresentaram resultados considerados satisfatórios, tanto em termos financeiros como em métricas estatísticas. Em períodos menores o resultado final pode ser impactado por notícias e acontecimentos inesperados, mas quando analisado em períodos de tempo maiores, as estratégias apresentadas mostraram-se capazes de gerar lucro frente aos benchmarks de mercado utilizados, podendo assim reduzir as incertezas de investimento em algumas situações e apresentando bons indicadores financeiros de risco e retorno.</p>
        <p>Como benchmarks de mercado para comparação foram utilizados a estratégia BH e o CDI, ambos indicadores comumente utilizados para mensurar o desempenho de investimentos. Na maioria dos casos, as estratégias utilizando modelos de RNAs mostraram-se capazes de superar tais indicadores, principalmente o BH quando os preços passam por forte tendência de queda.</p>
        <p>O sistema CNN-TA mostrou resultados melhores quando avaliado nos ativos do mercado americano, sendo 4 destes os mesmos utilizados na proposta original. Pode-se notar uma característica em comum dentre os 4 ativos utilizados para comparação, todos apresentaram uma tendência de queda no início do período de avaliação seguida de uma recuperação nos preços que corroborou para o resultado financeiro final. Quando analisado no mercado brasileiro, nos ativos onde houve uma tendência de alta durante o período analisado este sistema não se mostrou tão eficaz. Nas ações da PETR4 e ABEV3, onde o preço oscilou em uma faixa de valores na maior parte do tempo, este sistema apresentou resultados melhores, ganhando da proposta deste trabalho na PETR4.</p>
        <p>Os sistemas MLP e LSTM apresentaram comportamentos variados. O MLP não apresentou os melhores resultados em nenhum dos ativos avaliados. Entretanto em alguns casos este aproximou-se do comportamento do CNN-TC. Já o LSTM apresentou o melhor retorno financeiro na ação JPM e se aproximou dos sistemas baseados em CNN nas ações WEGE3 e WFC. Apesar de ambos os sistemas haverem apresentado boas métricas, pode-se notar menor capacidade de generalização para classificação dos momentos de operação quando comparado com o sistema CNN-TC.</p>
        <p>O sistema CNN-TC foi capaz de analisar dados de séries temporais e executar classificação de sinal de negociação, obtendo retornos expressivos quando comparado às demais estratégias, onde das 12 avaliações realizadas, em 6 apresentou resultados financeiros superiores, e considerando somente as estratégias utilizando RNAs, este foi melhor em 9 ativos. Embora a vantagem nas métricas tenha sido por pequena diferença em alguns casos, este demonstrou maior capacidade para identificação e classificação dos padrões nas séries analisadas.</p>
        <p>Nota-se ainda que o método de rotulagem proposto neste trabalho apresenta resultados melhores quando comparado ao da proposta do CNN-TA. Pode-se concluir que este método, em conjunto com métricas melhores proporcionadas pelo CNN-TC (ou próximas do sistema CNN-TA em alguns casos), permitiram retornos financeiros superiores para o CNN-TC. </p>
        <p>Vale ressaltar que os resultados financeiros dos sistemas mostraram-se distantes do retorno total possível com 100% de precisão para os rótulos gerados por ambos os métodos, e que em alguns casos, um pequena diferença de métricas mostrou resultados financeiros evidentemente diferentes. Isto reforça a necessidade de que um sistema de negociação deve ser preciso a fim de garantir retornos vantajosos frente às estratégias mais básicas de investimento, e evidencia que pequenas diferenças para este tipo de classificação podem influenciar os resultados a longo prazo.</p>
        <p>O teste em ambiente simulado, apesar de realizado em um período relativamente curto, também apresentou bons resultados, alcançando retorno financeiro superior à estratégia BH, o que valida a aplicabilidade desta pesquisa em cenários reais.</p>
        <p>O estudo nesta área de pesquisa exige um grande conhecimento interdisciplinar em tópicos como estatística, econometria, finanças, e inteligência artificial. Apesar de existirem variáveis não consideradas neste estudo, como notícias, fatores econômicos e fatos relevantes relacionados às empresas em específico, o retorno financeiro das avaliações mostrou-se vantajoso quando comparado com a estratégia BH, a mais básica do mercado de renda variável. Sendo assim, os resultados mostraram-se promissores para um sistema de negociação automatizado.</p>
        <p>Este trabalho teve sua contribuição e resultados iniciais publicados no evento XVII Encontro Nacional de Inteligência Artificial e Computacional.</p>
    <h2>Trabalhos Futuros</h2>
        <p>A quantidade e a qualidade dos dados de entrada é um fator que afeta a qualidade da previsão das RNAs. Neste trabalho, para o CNN-TC foram considerados apenas alguns recursos de entrada de forma empírica. É possível analisar e incluir outros elementos que possam contribuir positivamente para melhorar a classificação. Acredita-se que possam existir elementos, como dados econômicos que impactem diretamente as empresas, que podem melhorar a capacidade de previsão. Como exemplo, pode-se citar a empresa Petrobras S.A. que sofre influência da cotação do barril do petróleo, e a Vale S.A. que tem influência da cotação do minério de ferro no seu lucro operacional. Tais dados podem complementar a predição da tendência destes ativos. Além disso, existem indicadores que não foram explorados nesta pesquisa e que podem fornecer informações adicionais sobre o movimento dos preços, tais como Taxa de Variação (RSI), RSI estocástico e Volume de equilíbrio (OBV).</p>
        <p>Analisar dados financeiros das empresas pode ser um recurso importante para modelos de previsão e classificação, visto que o mercado tende a reagir a tais informações. Sendo assim, pode-se complementar o modelo com dados fundamentalistas, a fim de aprimorar a tomada de decisão.</p>
        <p>Para definição dos dados de entrada, pode-se aplicar análises matemáticas das variáveis disponíveis a fim de encontrar correlações que corroborem para melhor qualidade de classificação, tais técnicas como Análise de Componentes Principais (PCA).</p>
        <p>O processo de otimização dos parâmetros das RNAs é vital para a melhoria dos resultados. Pode-se utilizar de ferramentas como algoritmos de força bruta, ou mesmo algoritmos genéticos, a fim de encontrar melhores combinações para os modelos.</p>
        <p>Realizar experimentos em períodos menores, inclusive em operações de alta frequência. Neste trabalho considerou-se apenas o tempo gráfico diário, mas pode ser possível obter ganhos maiores realizando operações intradiárias. Independentemente do período considerado, a leitura dos indicadores permanece a mesma, o que indica que pode-se treinar um modelo em um tempo gráfico e utilizá-lo em outro.</p>
        <p>Os métodos de rotulagem apresentados neste trabalho são baseados apenas no histórico do preço de fechamento. É cabível um estudo a fim de determinar com base em fatores mais concretos os melhores momentos de compra e venda a fim de encontrar padrões que proporcionem melhores métricas estatísticas e maior rentabilidade financeira.</p>
        <p>Da mesma forma, o modo de operação considerou apenas o preço de fechamento. Pode-se analisar a tomada de decisão em outros momentos, como na abertura do mercado, a fim de proporcionar maiores ganhos financeiros bem como evitar perdas em momentos que o mercado é impactado por notícias no decorrer do dia.</p>
        <p>É possível avaliar a implementação de stop loss, uma forma de delimitar uma perda máxima por operação, para situações em que o mercado é impactado por notícias, a fim de garantir uma rentabilidade melhor a longo prazo.</p>
        <p>Por último, pode-se explorar modelos mais complexos de RNAs. Neste trabalho foram apresentadas comparações com redes LSTM. Estas têm como característica um tipo de memória de longo prazo, e acredita-se que possam fornecer recursos adicionais para a classificação. Sendo assim, sugere-se o estudo de modelos de arquiteturas mistas a fim de complementar os resultados finais.</p>
</body>
</html>