<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
    <div class="header_article">
        <h1>REDES NEURAIS PROFUNDAS PARA AUXÍLIO À TOMADA DE DECISÃO NO MERCADO DE AÇÕES</h1>
        <h3>GUSTAVO LUIZ GODOY BICHARA</h3>
        <p>Dissertação de Mestrado apresentada ao Programa de Pós-graduação em Engenharia Civil, COPPE, da Universidade Federal do Rio de Janeiro, como parte dos requisitos necessários à obtenção do título de Mestre em Engenharia Civil.</p>
        <h3>2019</h3>
    </div>
    
    <h2>RESUMO</h2>
    <p>Este trabalho apresenta a aplicação de uma rede neural profunda composta de Redes Neurais Convolucionais e Redes Neurais Recorrentes (Long Short-Term Memory) para extração semântica de notícias em língua portuguesa e processamento de indicadores técnicos da ação do Banco do Brasil ON (BBAS3). Aliado a isso, faz também o uso de filtros de entropia, baseados na entropia de Shannon, e combinação de modelos para criar um sistema de apoio à tomada de decisão de investimento. Ao longo da pesquisa, faz-se uma discussão das vantagens no uso de diferentes técnicas de Processamento de Linguagem Natural e do treinamento com janelas deslizantes. Os testes realizados indicam um elevado potencial para a aplicação conjunta destas técnicas, uma vez que atingem boa assertividade nas previsões dos movimentos da ação e conseguem retornos financeiros superiores aos benchmarks do mercado no período analisado.</p>
    
    <h2>1.Introdução</h2>
    <p>A capacidade de prever eventos futuros sempre instigou os seres humanos, principalmente quando isso permitiu a obtenção de uma vantagem competitiva. Seja ao fazer previsão de demanda para um determinado mercado, previsão do tempo para uma região ou previsão da evolução de cotações de ações, o que se espera é obter um bom suporte à decisão que conduza a resultados positivos, em termos de atendimento às demandas, otimização de produção ou realização de lucros.</p>
    <p>No universo de indicadores econômicos e financeiros, uma boa acurácia nas previsões de inflação, crescimento do PIB, taxas de juros, cotações de ações, taxas de câmbio, entre outras, ajudam a nortear decisões de investimentos tanto de empresas quanto de governos. Observando-se mais especificamente o mercado de capitais, há grande interesse das empresas na evolução das cotações de ações, derivativos, câmbio e índices, pois isso influencia sobremaneira em captação de recursos para realização e proteção de seus investimentos, mediante a emissão de novas ações, debêntures, hedge ou pelo uso de outros mecanismos financeiros [1]. Some-se a isso os investidores - pessoas físicas e jurídicas - que buscam no mercado de capitais boas opções de investimento para aumento patrimonial, renda extra, formação de previdência ou apenas como capital especulativo, criando-se, desta forma, o ambiente ideal para negociação de ativos com elevada liquidez e grande variedade de relação risco/retorno.</p>
    <p>Neste cenário, os participantes do mercado que estiverem de posse das melhores previsões do movimento de ações terão vantagens sobre os demais participantes. E para isso, os diversos agentes do mercado utilizam alguns mecanismos que auxiliam no seu processo de tomada de decisão:</p>
    
    <p>Análise Fundamentalista: trata de estudos de fundamentos econômicos do mercado, setor de atuação da empresa, indicadores econômicos e financeiros, análise de balanços, fluxos de caixa e demonstrativos de resultados com o objetivo de identificar o verdadeiro valor de um ativo e se este está sendo negociado com valores depreciados ou apreciados [1]. É muito usado por grandes investidores, como fundos de pensão, grandes empresas, bancos, fundos de investimento e também por pessoas físicas.</p>
    <p>Análise Técnica: engloba uma ampla variedade de formas de estudar as oscilações dos preços dos ativos usando gráficos que explicitam os comportamentos de preços, volumes e indicadores de momento e tendência que auxiliam na tomada de decisão de compra e venda [2]. Tem entre os maiores usuários os pequenos investidores, traders, analistas de investimentos e profissionais de mesa de operações.</p>

    <p>Dadas as suas características, não se justifica a aplicação da análise fundamentalista no curto prazo, uma vez que se baseia em indicadores econômicos divulgados mensal ou trimestralmente e dados das empresas disponibilizados trimestralmente. Neste contexto, a análise técnica apresenta maior vantagem ao usar as flutuações de preços e volume financeiro diários ou intraday para gerar seus próprios indicadores.</p>
    <p>Além disso, as oscilações de curto prazo estão mais associadas às informações, privilegiadas ou não, que cada indivíduo possui sobre uma ação [3], enquanto as estratégias de longo prazo são motivadas por uma visão de valor da empresa [4]. Já a Hipótese dos Mercados Eficientes (Efficient Market Hypothesis - EMH) estabelece que os preços das ações refletem toda informação disponível até aquele momento e, por isso, estabelece que é impossível obter retornos superiores à média do mercado por meio de previsões, uma vez que os mercados não reagem a novas informações [5][6]. Em consonância com a EMH, a Teoria do Passeio Aleatório (Random Walk Hypothesis - RWH) afirma que a evolução dos preços das ações segue um passeio aleatório e, consequentemente, não pode ser previsto [7].</p>
    <p>Entretanto, com o uso de técnicas de machine learning, como redes neurais artificiais, aliadas à análise técnica, estudos publicados apresentaram boa assertividade na previsão dos movimentos do mercado [8][9], bem como maiores retornos e maior estabilidade nas previsões dos movimentos das ações usando redes neurais profundas e notícias publicadas nos meios de comunicação [10]-[16].</p>
    <p>Esses resultados devem-se ao crescente avanço dos algoritmos de machine learning, da capacidade de processamento das máquinas e da facilidade de aquisição de dados. Entre os algoritmos mencionados, destacam-se as Redes Neurais Recorrentes (Recurrent Neural Networks- RNN), em especial as redes Long Short-Term Memory (LSTM), que se sobressaem no processamento de séries temporais [17][18], e as Redes Neurais Convolucionais (Convolutional Neural Network – CNN), que vêm apresentando resultados diferenciados na obtenção da semântica de textos [19]-[22]. Outros trabalhos também obtiveram resultados expressivos usando diferentes tipos de algoritmos, como classificação Bayesiana [23][24], Máquinas de Vetores de Suporte [25]-[28] e Máquinas de Boltzmann Restritas [29] Diante disso, este trabalho busca aprofundar a pesquisa e aplicação de técnicas de machine learning em previsão dos movimentos das ações, variando técnicas de préprocessamento dos dados e formas de treinamento, bem como visa a aplicar filtros baseados na entropia de Shannon aos resultados e também verificar as vantagens do uso da combinação de modelos.</p>

    <h3>1.1. Motivação</h3>
    <p>Atualmente, no Brasil, o mercado de ações se desenvolve em torno da B3 (Brasil, Bolsa, Balcão), resultado da fusão entre a Bolsa de Valores de São Paulo, a Bolsa de Mercadorias e Futuros e a Companhia de Custódia e de Liquidação Financeira de Títulos, o que a torna a 5ª maior bolsa de mercado de capitais do mundo, com cerca de 360 empresas listadas, mais de dois mil papeis negociados, 1,2 milhões de negócios diários e mais de 12 bilhões de reais movimentados diariamente em 2018 [30].</p> 
    <p>Em vista disso, identificar uma boa oportunidade de negócios torna-se uma tarefa árdua, apesar de lucrativa, para investidores individuais. Devido à grande quantidade de índices, ativos e derivativos, muitos dados são gerados a partir das operações realizadas diariamente, necessitando-se, então, de um modelo robusto e com capacidade para processar estes dados, com a finalidade de auxiliar no processo de identificação de oportunidades e tomada de decisão.</p>
    <p>No entanto, séries temporais financeiras são séries não-lineares e não-estacionárias, e, por isso, de difícil previsão, não sendo adequadamente representadas por modelos lineares. Com isso, opta-se pelo uso de modelos não-lineares, com capacidade de captar tal evolução temporal, o que direciona aos algoritmos de machine learning, mais especificamente às redes CNN e LSTM.</p>
    <p>Diante da capacidade dos algoritmos de Redes Neurais Profundas em processar grande quantidade de dados e entregar bons resultados [10]-[16], estes se apresentam como uma opção interessante para um trabalho aplicado ao mercado brasileiro. Sendo assim, a presente pesquisa usa como base o modelo SI-RCNN aplicado por VARGAS, et al [16] na previsão dos movimentos das ações da Chevron, apresentado na Figura 1.</p>
    <p>O modelo SI-RCNN fez uso de notícias em inglês vetorizadas em word2vec-cbow com 300 dimensões, que são enviadas para um conjunto de três filtros convolucionais ([3x64], [4x64], [5x64] e deslocamento 1), pooling (tamanho 2 e deslocamento 2), concatenados e enviados uma LSTM de 128 unidades. Paralelamente, um conjunto de 7 indicadores técnicos é enviado para uma LSTM de 128 unidades. As saídas dessas duas redes LSTM intermediárias são, então, concatenadas, passam por uma camada totalmente conectada e seguem para uma saída binária ([1,0] = compra e [0,1] = venda) com função de ativação softmax [16].</p>
    <p>Com isso, pode-se verificar a aplicabilidade desses métodos à realidade do mercado nacional: preços com elevada volatilidade e notícias em língua portuguesa. Adicionalmente, busca-se implementar algumas melhorias ao modelo, com foco na obtenção de maior confiabilidade nos resultados.</p>

    <h3>1.2. Objetivos</h3>
    <p>Ante o exposto, este trabalho visa a desenvolver um estudo de machine learning para previsão de movimentação dos preços de ações no mercado financeiro, com o objetivo de obter uma saída que identifique a oscilação provável da cotação de um ativo (positiva, neutra ou negativa) e seu grau de certeza para o dia seguinte ao período analisado, auxiliando assim a tomada de decisão.</p>
    <p>Uma vez que o volume de ativos e dados disponíveis requerem elevada capacidade computacional para sua execução, optou-se pelo desenvolvimento de um modelo com escopo reduzido, contendo apenas uma ação e dados diários, mas observando sempre características que permitam sua escalabilidade para muitos papéis, histórico maior que 10 anos ou intervalo de dados em horas ou mesmo em minutos. Dessa forma, o trabalho de filtragem automática de oportunidades seria uma consequência da adoção em larga escala deste modelo, o que está fora do escopo deste trabalho.</p>
    <p>Para se chegar a um resultado de elevada confiabilidade, este trabalho busca transitar por algumas técnicas de pré-processamento, treinamento e pós-processamento, de modo a identificar as mais adequadas a este tipo problema. Sendo assim, objetiva-se responder aos seguintes pontos principais:</p>
    <ul>
        <li>Verificar a aplicabilidade do modelo SI-RCNN a uma ação do mercado brasileiro;</li>
        <li>Verificar se há vantagens no uso de notícias (apenas título) textuais em língua portuguesa sobre o modelo sem notícias;</li>
        <li>Avaliar as diferenças de um treinamento dinâmico de janela deslizante (sliding window) sobre o treinamento estático usado no modelo SI-RCNN (apresentados e discutidos na seção 6.4);</li>
        <li>Aplicar e analisar as potencialidades do ensemble de modelos sobre o uso de modelos individuais;</li>
        <li>Identificar se a aplicação da entropia de Shannon aos resultados dos modelos conduz a maior assertividade nas operações, condicionando a execução de uma operação a um elevado grau de certeza na saída da rede.</li>
    </ul>
    <p>Além disso, dentre as técnicas de pré-processamento textual, o trabalho faz uso de dois algoritmos de vetorização de palavras, testa a presença ou ausência de stopwords e faz pequenas variações na filtragem de palavras por frequência, visando a identificar se alguma delas apresenta vantagens sobre as demais, sendo estes considerados objetivos intermediários.</p>

    <h3>1.3. Estrutura do Trabalho</h3>
    <p>No Capítulo 1 faz-se uma introdução ao problema em questão, apresenta-se as motivações para o estudo, os objetivos e os trabalhos publicados que possuem relação e contribuíram com o desenvolvimento desta pesquisa. A Figura 2 ilustra o fluxo de trabalho seguido e a complexidade do modelo.</p>
    <p>O Capítulo 2 apresenta o Mercado Financeiro, seus conceitos gerais e as particularidades do Mercado de Ações. Em seguida, fala-se sobre a Hipótese dos 7 Mercados Eficientes e como a Análise Fundamentalista e a Análise Técnica confrontam essa hipótese. Este capítulo é base para a apresentação dos indicadores usados no préprocessamento dos dados.</p>
    <p>No Capítulo 3 é feita uma explanação sobre o Processamento de Linguagem Natural, seus desafios e formas de realizar o tratamento do texto e a representação vetorial de palavras. Posteriormente, são apresentados os dois métodos de vetorização de palavras que são usados na presente pesquisa. Esse corpo teórico fundamenta toda a linha de préprocessamento das notícias.</p>
    <p>Em seguida, o Capítulo 4 traz alguns conceitos do ramo conexionista do aprendizado de máquina, essencial para a construção do modelo da coluna de treinamento da Figura 2. Inicialmente, são apresentadas as Redes Neurais Artificiais, sua forma de treinamento e suas limitações, para depois se introduzir as Redes Neurais Recorrentes e sua facilidade em trabalhar com séries temporais. Por fim, faz-se uma explanação sobre as Redes Neurais Convolucionais, sua importância para capturar a semântica no tratamento de textos e sua capacidade de fazer uma precisa análise de sensibilidade.</p>
    <p>No Capítulo 5 são introduzidos os conceitos da Teoria da Informação, da Entropia de Shannon e como estes se aplicam aos problemas de machine learning. Em seguida, apresenta-se a técnica de Ensemble de Modelos, sua aplicação e as principais vantagens sobre o uso de modelos individuais. Estes conceitos são aplicados na etapa final do trabalho, após os testes, como forma de buscar maior assertividade do modelo.</p>
    <p>Já o Capítulo 6 permeia todo o diagrama da Figura 2, trata em detalhes a construção do modelo e dos cenários usados no presente trabalho, mostrando desde a obtenção dos dados e seu pré-processamento, passando pela arquitetura do modelo e formas de treinamento e chegando aos cenários analisados e às medidas de avaliação de resultados.</p>
    <p>Por fim, o Capítulo 7 apresenta os resultados dos cenários executados e discute-se as vantagens de cada abordagem que foi seguida no trabalho. O Capítulo 8 traz a conclusão acerca das questões colocadas previamente no Capítulo 1, bem como propostas de trabalhos futuros.</p>
    <p>Complementando o trabalho, são apresentadas as Referências Bibliográficas usadas para embasar a pesquisa: o Anexo A com informações adicionais sobre os cenários que fizeram parte da etapa inicial do estudo e, em seguida, foram descontinuados ao longo da evolução dos resultados, e o Anexo B que apresenta em maiores detalhes como ocorre o treinamento de vetores de palavras nos métodos GloVe e word2vec.</p>

    <h2>7.Resultados</h2>
    <p>Os resultados obtidos pelo modelo são apresentados em tabelas de forma agrupada por tipo de treinamento. Nelas é possível ver os resultados de AUC para cada cenário e as variações de acordo com o aumento do nível de certeza requerido pela entropia de Shannon. Cabe ressaltar que, ao aumentar a restrição da entropia, as operações somente são permitidas às saídas que se enquadrem nestes critérios e, em situações limites, onde o modelo não apresenta nenhuma previsão com baixa entropia, sua AUC final é “N/A”, uma vez que o sistema não foi capaz de operar.</p>
    <p>Os cenários são identificados seguindo-se a nomenclatura “dataset_stopwords_filtrodefrequência_vetorização”, ou seja, o cenário chamado “banknews_csw_k25_glove” corresponde ao uso do dataset de notícias banknews, com stopwords, frequência mínima da palavra de 25 vezes e representação GloVe.</p>
    <p>Os resultados dos cenários por tipo de treinamento são apresentados nas tabelas ímpares, da Tabela 13 à Tabela 23. Nelas podem ser vistos os resultados de AUC para os 20 diferentes cenários de texto, o resultado da combinação de modelos, identificado na linha “ensemble”, o resultado do cenário sem texto e uma média das AUCs dos cenários com texto, separados de acordo com o limiar de entropia aplicado. Esta estrutura de apresentação dos resultados permite que seja feita a avaliação da eficácia da entropia e da combinação de modelos dentro de cada tipo de treinamento. </p>
    <p>As tabelas pares, desde a Tabela 14 até a Tabela 24, apresentam quadros resumo, por tipo de treinamento, das quantidades de cenários com AUC maior do que 0,5, menor do que 0,5, iguais a 0,5 e sem operação. A forma de apresentação permite verificar como o filtro de entropia influencia na assertividade dos modelos, em especial quando se observa a evolução da relação entre as quantidades de cenários com AUC maior que 0,5 e as com AUC menor que 0,5 (última linha das tabelas). Resultados crescentes nesses valores, quando se aumenta a restrição de entropia, indicam um aumento na assertividade dos cenários em geral, reduzindo em maior escala as taxas de falso positivo por classe, ainda que as taxas de verdadeiro positivo por classe possam estar reduzindo também</p>
    <p>Posteriormente, faz-se um comparativo entre os resultados da combinação de modelos do treinamento estático e dos treinamentos dinâmicos, mostrado na Figura 25 e na Figura 26. Esta forma de apresentação dos resultados permite uma verificação das vantagens do treinamento de janela deslizante sobre o treinamento estático, bem como permite verificar qual tamanho de janela apresenta melhor resultado para o problema estudado.</p>
    <p>Na Tabela 13, observam-se valores de AUC abaixo de 0,5 na maior parte dos cenários na coluna “sem entropia”. Isso reflete a dificuldade do modelo em capturar as relações entre as notícias, indicadores e as mudanças do mercado ao longo do tempo. Da mesma forma, o cenário ensemble é incapaz da apresentar um bom resultado, tanto em termos absolutos (AUC menor que 0,5), quanto em comparação com os cenários individuais. Nota-se também a baixa certeza nas previsões, uma vez que um limiar de entropia de 0,95 é suficiente para que todos os cenários, com exceção do cenário sem texto, não executem nenhuma operação.</p>
    <p>Na Tabela 14, que mostra a evolução das quantidades de cenários de acordo com o resultado de AUC, percebe-se que quanto mais restritivo o limiar de entropia, menor a quantidade de cenários com AUC menor que 0,5. Isso é um indicativo de que o filtro de entropia impede que as saídas das redes com baixo grau de certeza resultem em operações erradas. A Tabela 15 apresenta os resultados dos cenários com o treinamento sliding window com janela de 250 dias. Observam-se valores de AUC iguais a 0,5 em muitos cenários, devido à rede indicar uma mesma resposta para todos os dias de teste, resultando em 100% de verdadeiro positivo e também de falso positivo em uma das classes. A possível causa disso é o pequeno tamanho da janela de treinamento, que pode enviesar o modelo, por uma tendência de curto prazo, a indicar sempre um determinado tipo de operação</p>
    <p>Da mesma forma, o cenário ensemble também recebe esse viés, não conseguindo apresentar um bom resultado, tanto em termos absolutos quanto em comparação com os cenários individuais. A exceção fica por conta de quando se limita a entropia em 0,8, onde o cenário combinado apresenta resultado superior aos individuais. Nota-se também a baixa certeza nas previsões, uma vez que um limiar de entropia de 0,9 é o suficiente para que a maioria dos cenários deixe de fazer previsões, e um limiar de 0,7 torne todos os cenários sem utilidade.</p>
    <p>Observando-se a Tabela 16, pode-se verificar que o número de cenários com AUC > 0,5 e o número com AUC < 0,5 aumentam até o limiar de 0,98 e depois diminuem. Esse comportamento difere do esperado, uma vez que se espera que os modelos incorram em menos erros e que a relação entre quantidade de cenários com AUC > 0,5 e AUC < 0,5 aumente progressivamente. Apesar disso, conforme o filtro da entropia fica mais restritivo, verifica-se novamente o comportamento adequado dos resultados, com a diminuição da quantidade de cenários com AUC baixo.</p>
    <p>Os resultados dos cenários com o treinamento sliding window com janela de 500 dias são apresentados na Tabela 17. Ao se usar uma janela de treinamento maior que os 250 dias, encontram-se resultados de AUC superiores em quase todos os cenários e, consequentemente, uma melhora na média dos resultados individuais e também do ensemble. Neste caso, observa-se que a aplicação conjunta do limiar da entropia e do ensemble resultam em resultados frequentemente superiores à média, culminando com um AUC superior a todos os cenários individuais, quando se solicita ao modelo uma entropia menor do que 0,7 para operar.</p>
    <p>A Tabela 18 mostra, para o treinamento sw500, que os resultados dos modelos apresentam o comportamento esperado com a aplicação mais restritiva da entropia de Shannon, ou seja, enquanto aumenta a quantidade de cenários com AUC > 0,5, diminuem os cenários com AUC < 0,5. Isso fica evidente na última linha do quadro, onde a relação de AUCs aumenta da esquerda para a direita.</p>
    <p>Prosseguindo no aumento do tamanho da janela de treinamento, a Tabela 19 apresenta os resultados dos cenários com o treinamento sliding window com janela de 750 dias. Nota-se, pela comparação entre as médias das AUCs, uma melhora nos resultados em relação aos cenários com janela de 500 dias, indicando que esse tamanho de janela melhora a capacidade dos modelos de capturar as relações entre notícias e indicadores, bem como prever corretamente o direcional do mercado. Isso também pode ser observado pelos valores de AUC terem ultrapassado pela primeira vez 0,55. Esses resultados superiores refletem diretamente nos resultados do modelo ensemble, que alcança AUCs acima da média dos cenários individuais.</p>
    <p>Sob a ótica das quantidades de cenários por grupo de AUC, o aumento da restrição da entropia resulta em mais modelos com AUC elevado e menos com AUC < 0,5, apresentando uma evolução gradativa da relação de AUC > 0,5 e AUC < 0,5, conforme pode ser visto na Tabela 20.</p>
    <p>Aumentando-se o tamanho de janela de treinamento sliding window para 1000 dias (Tabela 21), observa-se resultados similares ao observado com 750 dias, apesar de não haver nenhum cenário de destaque. Além disso, esta janela de treinamento também traz melhora nos resultados do ensemble, oscilando por valores de AUC superiores a 0,5 em todos os cenários com restrição de entropia. Ou seja, a restrição da entropia melhora os resultados dos cenários individuais e essa melhora também se reflete no ensemble.</p>
    <p>Em contrapartida, o quadro apresentado na Tabela 22 apresenta resultados inferiores ao do treinamento com 750 dias, com menor quantidade de cenários com AUC > 0,5 e ligeiro aumento dos cenários sem operação ao longo do aumento da restrição da entropia, porém, ainda conduzindo a uma evolução gradativa da relação de AUC > 0,5 e AUC < 0,5.</p>
    <p>Por fim, a Tabela 23 apresenta os resultados para o maior tamanho de janela de treinamento para o sliding window: 1250 dias. Apesar da significativa melhora nos resultados individuais com o dataset banknews, essa melhora não foi capitalizada pelo ensemble dos modelos, tendo oscilado em torno da AUC = 0,5 e só obtendo significativa melhora no cenário com entropia mais restritiva (entropia < 0,7).</p>
    <p>Da mesma forma que os cenários com janela de 1000 dias, houve aumento na quantidade de cenários com AUC > 0,5 e melhora ao longo do aumento da restrição da entropia, conforme pode ser visto na Tabela 24, levando a uma evolução gradativa da relação de AUC > 0,5 e AUC < 0,5. Cabe ressaltar que este tamanho de janela permitiu a mais nítida melhoria nesta relação de AUC, assim como também trouxe maior quantidade de cenários com AUC superior a 0,5.</p>
    <p>Compilando-se os resultados dos quadros resumo apresentados, observa-se na Figura 25um gráfico com a evolução da relação entre a quantidade de cenários com AUC > 0,5 e AUC < 0,5 com o aumento da restrição do limiar de entropia. Esse gráfico indica que conforme aumenta-se o nível de certeza requerido dos modelos, maior a quantidade de cenários que respondem com AUCs maiores que 0,5, ao menos tempo que diminui o número de cenários com AUC baixo. Ou seja, há um indicativo de melhoria nos resultados finais de previsão quando aplicados limiares mais restritivos na entropia.</p>
    <p>Além disso, agrupando-se os resultados dos modelos ensemble, é possível avaliar a evolução de seus desempenhos ao longo de situações mais restritivas de entropia, como apresentado na Figura 26. Pode-se perceber uma inclinação positiva nas curvas de evolução da AUC por tipo de treinamento conforme se solicita maiores níveis de certeza das respostas. Ou seja, em geral, as respostas de baixa certeza (ou elevada entropia) descartadas são predições ruins dos modelos, e que resultariam em falso positivo para a classe. Então, conforme são descartadas, os resultados de melhor certeza sobressaem e resultam em melhoria na AUC do modelo combinado.</p>

    <h3>7.1. Discussão</h3>
    <p>A compilação e a análise dos resultados apresentados permitem uma avaliação abrangente dos cenários testados ao longo deste estudo, endereçando os questionamentos abertos na seção 1.2, onde se enumeraram os objetivos deste trabalho.</p>
    <ul>
        <li>Aplicabilidade do modelo SI-RCNN a uma ação do mercado brasileiro:</li>
    </ul>
    <p>Os resultados dos testes para validação do modelo SI-RCNN à ação do Banco do Brasil (BBAS3) são apresentados no Anexo A. Essa divisão nos testes foi necessária, uma vez que o modelo original apresenta uma saída binária, indicando apenas compra ou venda, enquanto a presente pesquisa requer uma saída ternária, para permitir a adequada comparação entre cenários com e sem entropia, de modelos individuais e combinados.</p>

    <p>Para efeito desta análise, considerou-se um comparativo de acurácia (ACC) dos modelos, uma vez que o resultado apresentado por VARGAS et al. [16] fez uso dessa medida de avaliação. Ao todo, foram rodados 120 cenários em treinamento estático e os resultados de validação para cada cenário são apresentados na Tabela 27, enquanto os de teste são apresentado na Tabela 28. A Tabela 25 apresenta um comparativo das estatísticas apresentadas por estes resultados e o resultado apresentado pelo modelo SIRCNN original (VARGAS et al. [16]).</p>
    <p>Observa-se que os melhores resultados deste trabalho são similares aos apresentados no artigo de VARGAS et al. [16], indicando que o modelo se aplica a uma ação do mercado brasileiro com notícias em português. No entanto, em termos de média e mediana, as pequenas diferenças nas acurácias podem ser explicadas por dois diferentes fatores:</p>
    <ul>
        <p>A qualidade das representações vetoriais de palavras, uma vez que o word2vec em inglês é treinado com um corpus de mais de 100 bilhões de palavras gerando mais de 3 milhões de vetores de palavras2, enquanto em português usa apenas 1,3 bilhões gerando 935 mil vetores palavras [40];</p>
        <p>A diferente estrutura de linguagem entre o português e o inglês, que pode requerer pequenos ajustes de parâmetros nas redes convolucionais para captar melhor a semântica em português.</p>
    </ul>
    <p>Vantagens no uso de notícias:</p>
    <p>Observando-se de maneira geral todos os resultados apresentados nas tabelas ímpares, da Tabela 13 à Tabela 23, é notório que os cenários que fizeram uso de notícias textuais obtiveram resultados superiores aos que fizeram uso apenas dos indicadores. Além dos resultados de AUC em geral serem superiores, a exigência de maior grau de certeza para operar, ou seja, uma entropia menor nas saídas da rede, rapidamente retira os modelos sem texto de operação, mostrando que mesmo com alguns resultados positivos, há uma incerteza muito grande nas previsões.</p>
    <p>Apesar de BECKMANN [27] afirmar, em seu estudo, que o impacto das notícias no mercado de ações dura menos de 5 minutos, as notícias que são publicadas com os mercados fechados não têm meios de refletir nos preços das ações imediatamente. Os resultados apresentados na presente pesquisa têm a contribuir para o rol de trabalhos que indicam que as notícias podem auxiliar na previsão dos movimentos diários das ações, da mesma forma que ZHAI, et al. [10], LUSS e D’ASPREMONT [11], DING et al. [12], AKITA et al. [13] e VARGAS, et al. [14] [16]. Além disso, estes resultados se distanciam da Hipótese dos Mercados Eficientes, pois, ainda que as previsões sejam pouco superiores ao resultado puramente aleatório, eles indicam que é possível realizar previsões assertivas com base em notícias, uma vez que as ações ainda não incorporaram essas informações aos preços.</p>
    <ul>
        <li>Diferenças no treinamento estático e janela deslizante:</li>
    </ul>
    <p>Com relação ao uso da janela deslizante, esta pesquisa testou 5 variantes no tamanho da janela e cada uma apresentou particularidades nos resultados. Enquanto uma janela pequena de 250 dias não é capaz de treinar o modelo adequadamente, como pode ser visto pela elevada quantidade resultados de AUC ≤ 0,5 da Tabela 15, uma janela de 500 dias consegue apresentar resultados melhores (Tabela 17). Porém, este tamanho de janela ainda não traz certeza nas previsões, sendo incapaz de gerar resultados em alguns cenários de entropia mais restritiva.</p>
    <p>O uso de janelas maiores obteve resultados mais satisfatórios, como, por exemplo, nas janelas de 750, 1000 e 1250 dias, Tabela 19, Tabela 21 e Tabela 23, respectivamente. Observa-se melhora nas previsões e constante evolução da AUC nos cenários ensemble em ambientes de entropia restritiva, com destaque para os resultados com janela de 750 dias. No entanto, é importante ressaltar que mais estudos devem ser realizados para se encontrar tamanho de janela e de passo ideais, que permitam um treinamento que maximize a AUC dos modelos.</p>
    <p>Apesar dos resultados insatisfatórios com janela de 250 dias, todos os cenários com janela deslizante apresentaram resultados superiores ao treinamento estático, tanto individualmente quanto no ensemble, indicando uma vantagem para o uso de janela deslizante em problemas que envolvam séries temporais.</p>
    <ul>
        <li>Resultados da aplicação da entropia de Shannon:</li>
    </ul>
    <p>Um dos principais pontos desta pesquisa, a aplicação da Entropia de Shannon aos resultados dos modelos trouxe uma sensível melhora nos resultados. Com o aumento da restrição no limiar de entropia, cenários que apresentam saídas de elevada incerteza chegavam ao ponto de não realizar nenhuma operação, tornando-se virtualmente descartáveis. Por outro lado, os cenários que apresentaram maior grau de certeza nos resultados, notadamente os treinados com janela deslizante de 750, 1000 e 1250 dias, deixam de apresentar AUCs abaixo de 0,5 e passam a apresentar resultados de AUC superiores a 0,5.</p>
    <p>Os gráficos da Figura 25 e da Figura 26 mostram claramente a melhoria nos resultados, conforme se aumenta a restrição de entropia imposta aos cenários. Em outras palavras, a entropia de Shannon aplicada a modelos de previsão de séries temporais financeiras protege o investidor de duas formas: descartando respostas de baixa certeza, que elevam a taxa de falso positivo, e eliminando modelos de baixa confiabilidade.</p>
    <p>Cabe ressaltar que a aplicação de um filtro baseado na entropia de Shannon é muito útil em um problema no qual o usuário pode se abster de tomar uma decisão, como neste caso que envolve decisão de investimento. No entanto, os resultados também demonstram que um filtro de entropia muito restritivo pode inutilizar um modelo.</p>
    <p>Apesar deste trabalho ter apresentado os melhores resultados com filtros em torno de 0,8 e 0,7, para uma aplicação real mais testes devem ser realizados, com o objetivo de encontrar a linha de corte ideal, que maximize as taxas de acerto e minimize as taxas de erro, promovendo maiores retornos financeiros com o mínimo de risco possível – o que resulta em um outro problema de otimização com restrições.</p>
    <ul>
        <li>Vantagens no uso de ensemble de modelos:</li>
    </ul>
    <p>Outro ponto de elevada relevância nesta pesquisa, o ensemble de modelos não apresenta um resultado melhor do que cada modelo individualmente, principalmente em cenários sem restrição de entropia, apesar de seu AUC ser superiores à média dos AUCs dos cenários individuais. No entanto, como apresentado na Figura 26, essa técnica apresenta gradativo aumento na AUC quando combinado à entropia de Shannon, carregando consigo mais confiabilidade nos resultados. </p>
    <p>Conforme esperado, a combinação de modelos mostra que é muito dependente dos resultados de cada um dos modelos que o compõem. Ou seja, ele é capaz de combinar as respostas de cada modelo e retornar um melhor resultado, mas somente se os cenários individuais apresentarem um mínimo de assertividade para transmitir ao ensemble.</p>
    <ul>
        <li>Objetivos intermediários:</li>
    </ul>
    <p>Com relação aos objetivos intermediários, os resultados apresentados no Anexo A novamente dão o direcionamento. O uso de dois algoritmos de vetorização de palavras não evidenciou superioridade de nenhum dos dois. Tanto word2vec skip-gram quanto o GloVe apresentaram resultados similares, alternando-se entre os melhores resultados de acurácia.</p>
    <p>No entanto, quando comparados os resultados obtidos com e sem o uso das stopwords, há um indicativo de que há perda de semântica ao se retirar todas estas palavras do contexto, uma vez que os resultados com stopwords apresentam melhores acurácias.</p>
    <p>Analisando-se nos resultados por filtro de frequência de palavras, pode-se verificar melhores acurácias no uso das frequências mínimas de 2, 10, 15, 25 e 50 sobre os demais cenários. Apesar do destaque destes valores, não é possível afirmar que esses tamanhos de filtro de frequência influenciam sobremaneira nos resultados. Convém, porém, salientar que os cenários com filtro 50 apresenta um menor dataset de entrada no modelo e, consequentemente, consome menos recurso computacional.</p>
    <p>Novamente é importante observar que, devido às limitações desta pesquisa, estes resultados não são exaustivos e maiores avaliações devem ser realizadas para encontrar o tamanho ideal de janelas de treinamento, otimizar a linha de corte para o filtro de entropia, combinar modelos com diferentes topologias e cenários com outros tipos de indicadores, buscando maior assertividade.</p>

    <h3>7.2. Simulações de Investimento</h3>
    <p>Após avaliar os resultados dos cenários, faz-se necessário executar simulações de investimentos com o intuito de verificar se estes são capazes de gerar retornos financeiros em ambientes tão restritivos e de elevada competitividade, como detalhado na seção 6.6.2. Este trabalho trata da aplicação de redes neurais profundas para auxílio à tomada de decisão, mantendo-se a discricionariedade do operador de executar ou não a operação. No entanto, nesta simulação, optou-se por acatar todos os indicativos de compra e venda apresentados pelos modelos.</p>
    <p>Além disso, cabe aqui reafirmar que a assertividade de um modelo não é garantia de retorno financeiro pelos seguintes motivos principais:</p>
    <ul>
        <p>O direcional dos modelos está ajustado para prever alta ou queda na relação entre fechamento em t+1 e fechamento em t, enquanto só é possível operar na abertura de t+1 e fechamento de t+1, relação que não necessariamente possui o mesmo direcional;</p>
        <p>O modelo pode acertar muitos movimentos de baixa amplitude e errar os de grande amplitude, resultando em retorno negativo;</p>
        <p>Não foi implementada nenhuma estratégia de stop loss, que ajuda a limitar perdas;</p>
        <p>Há custos operacionais, tarifas e impostos que incidem nas operações de compra e de venda, independentemente de sua lucratividade, além da incidência do imposto de renda de 20% sobre os lucros.</p>
    </ul>

    <p>Considerando-se o direcionamento dado por esta pesquisa, optou-se por avaliar dois modelos que apresentam as qualidades indicadas na seção 7.1:</p>
    <ul>
        <li>Tipo de Treinamento: Sliding Window com janela de 750 dias, melhor resposta de treinamento para os modelos individuais e também para o ensemble;</li>
        <li>Modelos ensemble, pois apresentam resultados superiores aos modelos individuais;</li>
        <li>Limiar de entropia em 0,8 e 0,7, exigindo bom nível de certeza nas respostas.</li>
    </ul>
    <p>Os resultados da simulação de investimento podem ser visualizados na Tabela 26 e na Figura 27. Observa-se que os modelos considerados conseguiram superar os benchmarks do mercado, uma vez que o período de teste em questão apresenta um forte comportamento de queda no mercado de ações brasileiro. Ou seja, estratégias de comprar e segurar não são indicadas nesse período, e por isso seus resultados são bastante negativos.</p>


</body>
</html>